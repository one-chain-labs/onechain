# OneChain API

## OneChain CLI

OneChain provides a command line interface (CLI) tool to interact with the OneChain network, its features, and the Move programming language. The complete suite of tools is called the OneChain CLI, with commands grouped together by feature. Each group of commands is commonly referred to by its top-level command: OneChain Client CLI, OneChain Console CLI, OneChain Keytool CLI, OneChain Move CLI, and OneChain Validator CLI.

### Update CLI {/* {#update-cli} */}

To get the latest version of the CLI, you can run the following command from a terminal or console.

```sh
$ cargo install --locked --git https://github.com/one-chain-labs/onechain.git --features tracing one_chain
```

:::info

The `tracing` feature is important as it adds Move test coverage and debugger support in the OneChain CLI. Unless it is enabled you will not be able to use these two features.

:::

### OneChain CLI commands {/* {#onechain-cli-commands} */}

There are a number of top-level commands available, but the five most useful to users are the following. Use the `help` flag for the commands that are not documented yet. For example, `one_chain validator --help`.  

- **[OneChain Client CLI](#onechain-client-cli):** Use the `one_chain client` commands to interact with the OneChain network.
- **[OneChain Client PTB CLI](#onechain-client-ptb-cli):** Use the `one_chain client ptb` command to build and execute PTBs.
- **[OneChain Console CLI](#onechain-client-console-cli):** Use `one_chain console` to open an interactive console with the currently active network.
- **[OneChain Keytool CLI](#onechain-keytool-cli):** Use the `one_chain keytool` commands to access cryptography utilities.
- **[OneChain Move CLI](#onechain-move-cli):** Use the `one_chain move` commands to work with the Move programming language.
- **[OneChain Validator CLI](#onechain-validator-cli):** Use the `one_chain validator` commands to access tools useful for OneChain validators.



#### OneChain Client CLI {/* {#onechain-client-cli} */}

The OneChain CLI `client` command provides command-level access to interact with the OneChain network. Typical uses for `one_chain client` include publishing Move smart contracts, getting the information of an object, executing transactions, or managing addresses.

##### Check OneChain CLI installation {/* {#check-onechain-cli-installation} */}

Before you can use the OneChain CLI, you must install it. To check if the CLI exists on your system, open a terminal or console and type the following command:

```sh
$ one_chain --version
```

If the terminal or console responds with a version number, you already have the OneChain CLI installed.

If the command is not found, follow the instructions in [Install OneChain](#update-cli) to get the OneChain CLI on your system.

##### Commands {/* {#commands} */}

The following list itemizes all the available subcommands for the `one_chain client` command.

```
Usage: one_chain client [OPTIONS] [COMMAND]

Commands:
  active-address              Default address used for commands when none specified
  active-env                  Default environment used for commands when none specified
  addresses                   Obtain the Addresses managed by the client
  balance                     List the coin balance of an address
  call                        Call Move function
  chain-identifier            Query the chain identifier from the rpc endpoint
  dynamic-field               Query a dynamic field by its address
  envs                        List all OneChain environments
  execute-signed-tx           Execute a Signed Transaction. This is useful when the user prefers to sign elsewhere and use this command to execute
  execute-combined-signed-tx  Execute a combined serialized SenderSignedData string
  faucet                      Request gas coin from faucet. By default, it will use the active address and the active network
  gas                         Obtain all gas objects owned by the address. An address' alias can be used instead of the address
  merge-coin                  Merge two coin objects into one coin
  new-address                 Generate new address and keypair with keypair scheme flag {ed25519 | secp256k1 | secp256r1} with optional derivation path, default to m/44'/784'/0'/0'/0' for ed25519 or m/54'/784'/0'/0/0
                                  for secp256k1 or m/74'/784'/0'/0/0 for secp256r1. Word length can be { word12 | word15 | word18 | word21 | word24} default to word12 if not specified
  new-env                     Add new OneChain environment
  object                      Get object info
  objects                     Obtain all objects owned by the address. It also accepts an address by its alias
  pay                         Pay coins to recipients following specified amounts, with input coins. Length of recipients must be the same as that of amounts
  pay-all-oct                 Pay all residual OCT coins to the recipient with input coins, after deducting the gas cost. The input coins also include the coin for gas payment, so no extra gas coin is required
  pay-oct                     Pay OCT coins to recipients following following specified amounts, with input coins. Length of recipients must be the same as that of amounts. The input coins also include the coin for
                                  gas payment, so no extra gas coin is required
  publish                     Publish Move modules
  split-coin                  Split a coin object into multiple coins
  switch                      Switch active address and network(e.g., devnet, local rpc server)
  tx-block                    Get the effects of executing the given transaction block
  transfer                    Transfer object
  transfer-oct                Transfer OCT, and pay gas with the same OCT coin object. If amount is specified, only the amount is transferred; otherwise the entire object is transferred
  upgrade                     Upgrade Move modules
  verify-bytecode-meter       Run the bytecode verifier on the package
  verify-source               Verify local Move packages against on-chain packages, and optionally their dependencies
  profile-transaction         Profile the gas usage of a transaction. Unless an output filepath is not specified, outputs a file `gas_profile_{tx_digest}_{unix_timestamp}.json` which can be opened in a flamegraph
                                  tool such as speedscope
  replay-transaction          Replay a given transaction to view transaction effects. Set environment variable MOVE_VM_STEP=1 to debug
  replay-batch                Replay transactions listed in a file
  replay-checkpoint           Replay all transactions in a range of checkpoints
  help                        Print this message or the help of the given subcommand(s)

Options:
      --client.config <CONFIG>  Sets the file storing the state of our user accounts (an empty one will be created if missing)
      --json                    Return command outputs in json format
  -y, --yes
  -h, --help                    Print help
```

##### JSON output {/* {#json-output} */}

Append the `--json` flag to commands to format responses in JSON instead of the more human-friendly default OneChain CLI output. This can be useful for extremely large datasets, for example, as those results can have a troublesome display on smaller screens. In these cases, the `--json` flag is useful.

##### Examples {/* {#examples} */}

The following examples demonstrate some of the most often used commands.

###### List available network environments {/* {#list-available-network-environments} */}

Use the `one_chain client envs` command to find the network environments set up in the CLI. The information for these environments is also stored in the client.yaml file in the OneChain configuration directory (`~/.one/one_config`).

```sh
╭────────┬───────────────────────────────────┬────────╮
│ alias  │ url                               │ active │
├────────┼───────────────────────────────────┼────────┤
│ devnet │ https://rpc-devnet.onelabs.cc:443 │ *  	  │
╰────────┴───────────────────────────────────┴────────╯
```

###### Create network environment {/* {#create-network-environment} */}

Use `client new-env` to add details for a new network environment. This example creates an environment pointer to OneChain Mainnet. Setting the `alias` value makes referencing the environment less prone to typographical errors. After running this command, OneChain updates your client.yaml file in `~/.one/one_config` with the new information.

```
$ one_chain client new-env --alias=mainnet --rpc https://rpc-mainnet.onelabs.cc:443

Added new OneChain env [mainnet] to config.
```

###### Set current environment {/* {#set-current-environment} */}

Use the `one_chain client switch` command to change the current network. This example switches the current network to `mainnet`.

```sh
$ one_chain client switch --env mainnet
```
```sh
Active environment switched to [mainnet]
```

If you run `one_chain client envs` after this command, you see the asterisk in the `active` column on the `mainnet` row of the table.

###### Get current active address {/* {#get-current-active-address} */}

Use the `one_chain client active-address` command to reveal the current address. The CLI uses the current active address to execute address-specific CLI commands (like `one_chain client objects`) when you don't provide them with a OneChain address value.

```sh
$ one_chain client active-address
```
```sh
0x514692f08249c3e9951234ce29074695840422564bff85e424b56de462913e0d
```

###### Request a OCT coin from faucet {/* {#request-a-oct-coin-from-faucet} */}

If you use one of the standard public RPCs (for example, `rpc-devnet.onelabs.cc:443`), you can use the `faucet` command to request gas coins. If you use a custom faucet service, then pass in the URL to the faucet using the `--url` option.
The `faucet` command works for a local network, as well. If you start your network with a custom faucet port, include the `--url` option. 

```sh
$ one_chain client faucet
```
```sh
Request successful. It can take up to 1 minute to get the coin. Run one_chain client gas to check your gas coins.
```

###### Get objects owned by an address {/* {#get-objects-owned-by-an-address} */}

Use `one_chain client objects` to list summary information about the objects the current active address owns. You can provide a OneChain address value to the command to list objects for a particular address. This example lists objects for the current active address.

```sh
$ one_chain client objects 0x36df11369cf00ecf0be68d6ba965b0abe2e883bc5245911e3a29ebfa0aaf6b69
```
```sh
╭───────────────────────────────────────────────────────────────────────────────────────╮
| ╭────────────┬──────────────────────────────────────────────────────────────────────╮ │
│ │ objectId   │  0xfffbb30ccb631f15f6cd36700589fc9c31cb04af28a95f3ed26d62daf3acb57f  │ │
│ │ version	   │  33363559                                                        	  │ │
│ │ digest 	   │  IY7/qsIJhliQL0uxwSzNYu0SMcn5AMsqQklSGngn1V0=                    	  │ │
│ │ objectType │  0x0000..0002::coin::Coin                                        	  │ │
│ ╰────────────┴──────────────────────────────────────────────────────────────────────╯ │
│ ╭────────────┬──────────────────────────────────────────────────────────────────────╮ │
│ │ objectId   │  0xfffe59fb6f78b1ced7f6537e69a205cc45d105270857bfd66332f9a627a38ae0  │ │
│ │ version	   │  33370864                                                            │ │
│ │ digest     │  b+tKChvujbCk/UCm8L+lflyb6Vjt7beB+uz6+ahUHmM=                    	  │ │
│ │ objectType │  0x0000..0002::coin::Coin                                        	  │ │
│ ╰────────────┴──────────────────────────────────────────────────────────────────────╯ │
╰───────────────────────────────────────────────────────────────────────────────────────╯
```

###### Get complete object information {/* {#get-complete-object-information} */}

Use `one_chain client object <OBJECT-ID>` to list object information for the ID you provide. This example displays the information for a Coin object.

```sh
$ one_chain client object 0xfffbb30ccb631f15f6cd36700589fc9c31cb04af28a95f3ed26d62daf3acb57f
```
```sh
╭───────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ objectId      │  0xfffbb30ccb631f15f6cd36700589fc9c31cb04af28a95f3ed26d62daf3acb57f                                                 │
│ version       │  33363559                                                                                                           │
│ digest        │  3FzvXJVVVcXb9H6dEXdARaY9EmxXyyNFduet3X4eYV4x                                                                       │
│ objType       │  0x2::coin::Coin<0x2::oct::OCT>                                                                                     │
│ ownerType     │  AddressOwner                                                                                                       │
│ prevTx        │  ES2RQThjRE5u8rwiUEnhcnMoLA3cHeEGYJ8Pq98tmyAc                                                                       │
│ storageRebate │  988000                                                                                                             │
│ content       │ ╭───────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────╮ │
│               │ │ dataType          │  moveObject                                                                                 │ │
│               │ │ type              │  0x2::coin::Coin<0x2::oct::OCT>                                                             │ │
│               │ │ hasPublicTransfer │  true                                                                                       │ │
│               │ │ fields            │ ╭─────────┬───────────────────────────────────────────────────────────────────────────────╮ │ │
│               │ │                   │ │ balance │  530076676                                                                    │ │ │
│               │ │                   │ │ id      │ ╭────┬──────────────────────────────────────────────────────────────────────╮ │ │ │
│               │ │                   │ │         │ │ id │  0xfffbb30ccb631f15f6cd36700589fc9c31cb04af28a95f3ed26d62daf3acb57f  │ │ │ │
│               │ │                   │ │         │ ╰────┴──────────────────────────────────────────────────────────────────────╯ │ │ │
│               │ │                   │ ╰─────────┴───────────────────────────────────────────────────────────────────────────────╯ │ │
│               │ ╰───────────────────┴─────────────────────────────────────────────────────────────────────────────────────────────╯ │
╰───────────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
```

###### Get dynamic fields of an object {/* {#get-dynamic-fields-of-an-object} */}

Use the `one_chain client dynamic-field <DYNAMIC-FIELD-ID>` command to list the details of the dynamic field with the ID you provide.

```sh
$ one_chain client dynamic-field 0x5
```
```sh
╭─────────────┬───────────────────────────────────────────────────────────────────────────────────────────╮
│ hasNextPage │  false                                                                                	  │
│ nextCursor  │  0x5b890eaf2abcfa2ab90b77b8e6f3d5d8609586c3e583baf3dccd5af17edf48d1                   	  │
│ data     	  │ ╭───────────────────────────────────────────────────────────────────────────────────────╮ │
│         	  │ │ ╭────────────┬──────────────────────────────────────────────────────────────────────╮ │ │
│         	  │ │ │ name   	   │ ╭───────┬───────╮                                                	  │ │ │
│         	  │ │ │        	   │ │ type  │  u64  │                                                	  │ │ │
│         	  │ │ │        	   │ │ value │  2    │                                                	    │ │ │
│         	  │ │ │        	   │ ╰───────┴───────╯                                                	  │ │ │
│         	  │ │ │ bcsName	   │  LQM2cdzDY3                                                      	  │ │ │
│         	  │ │ │ type   	   │  DynamicField                                                    	  │ │ │
│         	  │ │ │ objectType │  0x3::sui_system_state_inner::SuiSystemStateInnerV2              	  │ │ │
│         	  │ │ │ objectId   │  0x5b890eaf2abcfa2ab90b77b8e6f3d5d8609586c3e583baf3dccd5af17edf48d1  │ │ │
│         	  │ │ │ version	   │  112                                                             	  │ │ │
│         	  │ │ │ digest 	   │  HMrm1KNKjq3GfB1cWTRdvRo8gk7auhgvoZXaVoyEHqUR                    	  │ │ │
│         	  │ │ ╰────────────┴──────────────────────────────────────────────────────────────────────╯ │ │
│         	  │ ╰───────────────────────────────────────────────────────────────────────────────────────╯ │
╰─────────────┴───────────────────────────────────────────────────────────────────────────────────────────╯
```

###### Send OCT or objects {/* {#send-oct-or-objects} */}

In this example, let's see how to transfer OCT or transfer an object from one address to another. First of all, there two main commands for sending OCT or transferring objects: `pay` and `transfer`. 
Both `pay` and `transfer` have a few sister commands: `pay-oct`, `pay-all-oct`, `transfer-oct`. 

The differences between these commands are:
- commands that end in `-oct` deal with OneChain's native coin, and they use the input coints to pay for gas and for transferring OCT or the object.
- `pay-` commands typically deal with coins and handle gas smashing for you, whereas `transfer` commands can handle the transfer of any object that has public transfer, meaning any object that has the `store` ability. 
- `pay` commands allow you to send coins to multiple recipients, whereas `transfer` commands only accept one recipient.
- `pay-all-oct` is a special case of `pay-oct` that offers a way to transfer the entire balance after smashing.
- `transfer-oct` is a legacy command and has been entirely superseded by `pay-oct` or `pay-all-oct` depending on whether an amount is specified or not.

Assume you have two addresses:

```sh
╭───────────────────┬────────────────────────────────────────────────────────────────────┬────────────────╮
│ alias             │ address                                                            │ active address │
├───────────────────┼────────────────────────────────────────────────────────────────────┼────────────────┤
│ hungry-spodumene  │ 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea │ *              │
│ eloquent-amber    │ 0x3d78abc33ccd173c521b4f9e78b21ea2c989960b631732c539efaa38bda30976 │                │
╰───────────────────┴────────────────────────────────────────────────────────────────────┴────────────────╯
````

Address `hungry-spodumene` has a few coins:

```sh
$ one_chain client gas hungry-spodumene
```
```sh
╭────────────────────────────────────────────────────────────────────┬────────────────────┬───────────────╮
│ gasCoinId                                                          │ mistBalance (MIST) │ balance (OCT) │
├────────────────────────────────────────────────────────────────────┼────────────────────┼───────────────┤
│ 0x205972830acd8264a38b9a1776a1b72a1ae626fa23a4d1f12249349ce3b83c06 │ 200000000000       │ 200.00        │
│ 0x56d76420a5bc7d356e3930e6a2ddc61cbbc0c87ea5c5f3cc3ac5952b4d52be5a │ 200000000000       │ 200.00        │
│ 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52 │ 200000000000       │ 200.00        │
│ 0xe373de9bdbd3dbd4f5f707f144c83af74a181cdb3903a953ee366f48e33865c7 │ 200000000000       │ 200.00        │
│ 0xf7adb6aeb18eb409c03fe88cc31711b61a65333e0fdd88c1815d4ec75f713f31 │ 200000000000       │ 200.00        │
╰────────────────────────────────────────────────────────────────────┴────────────────────┴───────────────╯
```

You want to send 0.5 OCT to `eloquent-amber`. Given that you have a few gas coins, you can use `pay`. If only one gas coin exists, then you need to use `transfer-oct` or `pay-oct`, or you would need to split the coin first to have another coin to use for paying gas. In this case, let's use the `pay-oct` command as you do not need to provide a separate gas coin to be used for the gas fees. In the command below, you set the recipient to be `eloquent-amber`, which coin to use to transfer OCT from, and the amount of OCT to transfer.

:::tip

Beginning with the OneChain [release](https://github.com/one-chain-labs/onechain/releases/tag/main), the `--gas-budget` option is no longer required for CLI commands.

:::

```sh
$ one_chain client pay-oct --recipients eloquent-amber --input-coins 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52 --amounts 500000000 --gas-budget 5000000
```

The result is:

```sh
Transaction Digest: AsWkciVhLHeCmqVipjjyAA7Hv5y87pFjHS59K8m4zBJV
╭──────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Transaction Data                                                                                             │
├──────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Sender: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                                   │
│ Gas Owner: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                                │
│ Gas Budget: 5000000 MIST                                                                                     │
│ Gas Price: 1000 MIST                                                                                         │
│ Gas Payment:                                                                                                 │
│  ┌──                                                                                                         │
│  │ ID: 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52                                    │
│  │ Version: 2                                                                                                │
│  │ Digest: 9MEH7kr1YkBDx7pdUPCDnVb3FtPz9UZVeWmCot5Dhxqr                                                      │
│  └──                                                                                                         │
│                                                                                                              │
│ Transaction Kind: Programmable                                                                               │
│ ╭──────────────────────────────────────────────────────────────────────────────────────────────────────────╮ │
│ │ Input Objects                                                                                            │ │
│ ├──────────────────────────────────────────────────────────────────────────────────────────────────────────┤ │
│ │ 0   Pure Arg: Type: address, Value: "0x3d78abc33ccd173c521b4f9e78b21ea2c989960b631732c539efaa38bda30976" │ │
│ │ 1   Pure Arg: Type: u64, Value: "500000000"                                                              │ │
│ ╰──────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
│ ╭──────────────────────╮                                                                                     │
│ │ Commands             │                                                                                     │
│ ├──────────────────────┤                                                                                     │
│ │ 0  SplitCoins:       │                                                                                     │
│ │  ┌                   │                                                                                     │
│ │  │ Coin: GasCoin     │                                                                                     │
│ │  │ Amounts:          │                                                                                     │
│ │  │   Input  1        │                                                                                     │
│ │  └                   │                                                                                     │
│ │                      │                                                                                     │
│ │ 1  TransferObjects:  │                                                                                     │
│ │  ┌                   │                                                                                     │
│ │  │ Arguments:        │                                                                                     │
│ │  │   Result 0        │                                                                                     │
│ │  │ Address: Input  0 │                                                                                     │
│ │  └                   │                                                                                     │
│ ╰──────────────────────╯                                                                                     │
│                                                                                                              │
│ Signatures:                                                                                                  │
│    eZc/iFO3i4Y8Le92zu9q75jILs+yg0sSXd1yPV9Dta+knH99VfkSCnzNQG1KbXSvY24wexmVtiuU6NkfudbiAQ==                  │
│                                                                                                              │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Transaction Effects                                                                               │
├───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Digest: AsWkciVhLHeCmqVipjjyAA7Hv5y87pFjHS59K8m4zBJV                                              │
│ Status: Success                                                                                   │
│ Executed Epoch: 0                                                                                 │
│                                                                                                   │
│ Created Objects:                                                                                  │
│  ┌──                                                                                              │
│  │ ID: 0xa031d3f8fd53b5f9885172e1c6bd8b770b25e42371c9ee215c6d4b21b2b73241                         │
│  │ Owner: Account Address ( 0x3d78abc33ccd173c521b4f9e78b21ea2c989960b631732c539efaa38bda30976 )  │
│  │ Version: 3                                                                                     │
│  │ Digest: Fq3maqq3pShgKw58Ssm8cS2j1pspfhanedVK2MMxfQWQ                                           │
│  └──                                                                                              │
│ Mutated Objects:                                                                                  │
│  ┌──                                                                                              │
│  │ ID: 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52                         │
│  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
│  │ Version: 3                                                                                     │
│  │ Digest: GFB9mpxTP4z6CCShTbvD58FYxtu9G4mnxN3JtFeRupM3                                           │
│  └──                                                                                              │
│ Gas Object:                                                                                       │
│  ┌──                                                                                              │
│  │ ID: 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52                         │
│  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
│  │ Version: 3                                                                                     │
│  │ Digest: GFB9mpxTP4z6CCShTbvD58FYxtu9G4mnxN3JtFeRupM3                                           │
│  └──                                                                                              │
│ Gas Cost Summary:                                                                                 │
│    Storage Cost: 1976000 MIST                                                                     │
│    Computation Cost: 1000000 MIST                                                                 │
│    Storage Rebate: 978120 MIST                                                                    │
│    Non-refundable Storage Fee: 9880 MIST                                                          │
│                                                                                                   │
│ Transaction Dependencies:                                                                         │
│    GThyjtRFysBgVppXDc9iduNPzB2bLteXBnJcBEYXz4vG                                                   │
╰───────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────╮
│ No transaction block events │
╰─────────────────────────────╯

╭──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Object Changes                                                                                   │
├──────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Created Objects:                                                                                 │
│  ┌──                                                                                             │
│  │ ObjectID: 0xa031d3f8fd53b5f9885172e1c6bd8b770b25e42371c9ee215c6d4b21b2b73241                  │
│  │ Sender: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                    │
│  │ Owner: Account Address ( 0x3d78abc33ccd173c521b4f9e78b21ea2c989960b631732c539efaa38bda30976 ) │
│  │ ObjectType: 0x2::coin::Coin<0x2::oct::OCT>                                                    │
│  │ Version: 3                                                                                    │
│  │ Digest: Fq3maqq3pShgKw58Ssm8cS2j1pspfhanedVK2MMxfQWQ                                          │
│  └──                                                                                             │
│ Mutated Objects:                                                                                 │
│  ┌──                                                                                             │
│  │ ObjectID: 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52                  │
│  │ Sender: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                    │
│  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea ) │
│  │ ObjectType: 0x2::coin::Coin<0x2::oct::OCT>                                                    │
│  │ Version: 3                                                                                    │
│  │ Digest: GFB9mpxTP4z6CCShTbvD58FYxtu9G4mnxN3JtFeRupM3                                          │
│  └──                                                                                             │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Balance Changes                                                                                   │
├───────────────────────────────────────────────────────────────────────────────────────────────────┤
│  ┌──                                                                                              │
│  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
│  │ CoinType: 0x2::oct::OCT                                                                        │
│  │ Amount: -501997880                                                                             │
│  └──                                                                                              │
│  ┌──                                                                                              │
│  │ Owner: Account Address ( 0x3d78abc33ccd173c521b4f9e78b21ea2c989960b631732c539efaa38bda30976 )  │
│  │ CoinType: 0x2::oct::OCT                                                                        │
│  │ Amount: 500000000                                                                              │
│  └──                                                                                              │
╰───────────────────────────────────────────────────────────────────────────────────────────────────╯

```

Check the gas for the sender and the recipient's coins using `one_chain client gas <address>`. The sender now has 199.49 OCT for that gas coin that was used. 0.5 OCT was transferred, and the remaining 0.01 OCT paid the gas fees.
```sh
$ one_chain client gas
```
```sh
╭────────────────────────────────────────────────────────────────────┬────────────────────┬───────────────╮
│ gasCoinId                                                          │ mistBalance (MIST) │ balance (OCT) │
├────────────────────────────────────────────────────────────────────┼────────────────────┼───────────────┤
│ 0x205972830acd8264a38b9a1776a1b72a1ae626fa23a4d1f12249349ce3b83c06 │ 200000000000       │ 200.00        │
│ 0x56d76420a5bc7d356e3930e6a2ddc61cbbc0c87ea5c5f3cc3ac5952b4d52be5a │ 200000000000       │ 200.00        │
│ 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52 │ 199498002120       │ 199.49        │
│ 0xe373de9bdbd3dbd4f5f707f144c83af74a181cdb3903a953ee366f48e33865c7 │ 200000000000       │ 200.00        │
│ 0xf7adb6aeb18eb409c03fe88cc31711b61a65333e0fdd88c1815d4ec75f713f31 │ 200000000000       │ 200.00        │
╰────────────────────────────────────────────────────────────────────┴────────────────────┴───────────────╯
```
```sh
$ one_chain client gas eloquent-amber
```
```sh
╭────────────────────────────────────────────────────────────────────┬────────────────────┬───────────────╮
│ gasCoinId                                                          │ mistBalance (MIST) │ balance (OCT) │
├────────────────────────────────────────────────────────────────────┼────────────────────┼───────────────┤
│ 0xa031d3f8fd53b5f9885172e1c6bd8b770b25e42371c9ee215c6d4b21b2b73241 │ 500000000          │ 0.50          │
╰────────────────────────────────────────────────────────────────────┴────────────────────┴───────────────╯
```

If you want to transfer the whole object, you can use `one_chain client pay-all-oct` or `one_chain client transfer-oct` (without passing the amount): 
```sh
$ one_chain client pay-oct --recipient eloquent-amber --input-coins 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52 --gas-budget 5000000
```
or
```sh
$ one_chain client transfer-oct --to eloquent-amber --sui-coin-object-id 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52 --gas-budget 5000000
```

Then check the gas for `eloquent-amber` again:
```sh
$ one_chain client gas eloquent-amber
```
```sh
╭────────────────────────────────────────────────────────────────────┬────────────────────┬───────────────╮
│ gasCoinId                                                          │ mistBalance (MIST) │ balance (OCT) │
├────────────────────────────────────────────────────────────────────┼────────────────────┼───────────────┤
│ 0xa031d3f8fd53b5f9885172e1c6bd8b770b25e42371c9ee215c6d4b21b2b73241 │ 500000000          │ 0.50          │
│ 0xc9b447fff18f13fa035e028534b8344d5fc8a8760248fad10155e78f44dc3a52 │ 199496992240       │ 199.49        │
╰────────────────────────────────────────────────────────────────────┴────────────────────┴───────────────╯
```


###### Replay a transaction {/* {#replay-a-transaction} */}

Use the `one_chain client replay-transaction --tx-digest <TRANSACTION-DIGEST>` to re-execute a transaction locally and show the transaction effects.
This command will fetch the transaction dependencies from the Full node specified in the client env. For transactions that happened quite far in
the past, it is advised to set the client Full node to one that has non-pruned chain data for that transaction.
This will also verify that the resulting effects from the locally executed transaction match the effects of the transaction stored on-chain.

You can add additional flags `--gas-info` and `--ptb-info` to this command to see more information about the transaction.

```sh
$ one_chain client replay-transaction --tx-digest 51MzJP2Uesvza8vXGpPCGbfLrY6UCfdvdoErN1z4oXPW
```
```sh
╭───────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Transaction Effects                                                                               │
├───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Digest: 51MzJP2Uesvza8vXGpPCGbfLrY6UCfdvdoErN1z4oXPW                                              │
│ Status: Success                                                                                   │
│ Executed Epoch: 237                                                                               │
│                                                                                                   │
│ Mutated Objects:                                                                                  │
│  ┌──                                                                                              │
│  │ ID: 0x0000000000000000000000000000000000000000000000000000000000000006                         │
│  │ Owner: Shared                                                                                  │
│  │ Version: 20303014                                                                              │
│  │ Digest: 3FyU88FpFFa2mhDFJWcabwQNdfaVaWvvnbjkfErD6AgJ                                           │
│  └──                                                                                              │
│                                                                                                   │
│ Shared Objects:                                                                                   │
│  ┌──                                                                                              │
│  │ ID: 0x0000000000000000000000000000000000000000000000000000000000000006                         │
│  │ Version: 20303013                                                                              │
│  │ Digest: 7uGV3aHa9NDAWLX1UUyV1DG7wAuhfFkzSGo514wtco1C                                           │
│  └──                                                                                              │
│                                                                                                   │
│ Gas Object:                                                                                       │
│  ┌──                                                                                              │
│  │ ID: 0x0000000000000000000000000000000000000000000000000000000000000000                         │
│  │ Owner: Account Address ( 0x0000000000000000000000000000000000000000000000000000000000000000 )  │
│  │ Version: 0                                                                                     │
│  │ Digest: 11111111111111111111111111111111                                                       │
│  └──                                                                                              │
│                                                                                                   │
│ Gas Cost Summary:                                                                                 │
│    Storage Cost: 0                                                                                │
│    Computation Cost: 0                                                                            │
│    Storage Rebate: 0                                                                              │
│    Non-refundable Storage Fee: 0                                                                  │
│                                                                                                   │
│ Transaction Dependencies:                                                                         │
│    EvDLzYeKbrxDNHJomgrr2zwAJ7FJDtb2uNwfbonF2uGK                                                   │
╰───────────────────────────────────────────────────────────────────────────────────────────────────╯
Execution finished successfully. Local and on-chain effects match.
```

Use `one_chain client replay-batch --path <FILEPATH>` to replay several transactions listed in a newline-separated file. This
will verify that all transactions local execution results match the effects on-chain.

###### Profile a transaction {/* {#profile-a-transaction} */}

Use the `one_chain client profile-transaction --tx-digest <TRANSACTION-DIGEST>` command to re-execute a transaction locally
and produce a gas profile. Similar to the `replay` command, this command fetches the transaction dependencies from the
Full node specified in the client environment that are needed to execute the transaction. During the local execution of the transaction,
this command records all the Move function invocations and the gas cost breakdown for each invocation.

To enable the profiler, you must either install or build the OneChain Client binary locally with the `--features tracing` flag if it has not already been built with that feature enabled.

```sh
$ cargo install --locked --git https://github.com/one-chain-labs/onechain.git --branch <BRANCH-NAME> --features tracing one_chain
```

The command outputs a profile to the current working directory in the format `gas_profile_{tx_digest}_{unix_timestamp}.json`.
You can include the optional flag `--profile-output </PATH/OUTPUT.json>` to write the profile to `/PATH/OUTPUT_{tx_digest}_{unix_timestamp}.json` instead.
Use [speedscope](https://www.speedscope.app/) to inspect the profile.

To install speedscope run

```sh
$ npm install -g speedscope
```

To open a profile in speedscope run

```sh
$ speedscope <PATH/PROFILE-OUTPUT-FILE>
```

When looking at the profile in speedscope, there are three different views available from the top left menu: **Timer Order**,
**Left Heavy**, and **Sandwich**. In each view, each bar's vertical width corresponds to the percentage of gas consumption incurred by the function,
and you can hover your mouse over a bar or click a bar to see the computation units accrued by the function invocation. The transaction's total computation units, along with the storage computation units, are multiplied by the gas price to determine the gas cost of the transaction based on a tier system.

**Time Order** shows the callstack of function invocations from left to right in the order
of invocation, while **Left Heavy** combines repeated sequences of nested invocations into a single combined call stack. **Left Heavy** 
displays these sequences from left to right by total incurred gas consumption per combined call stack. This is useful when there have
been hundreds of repeated calls to the same function to quickly observe the total gas consumption over all calls to that function.
In both these views, you can click the top section and drag to zoom in and out over different sections of the profile.

**Sandwich** view shows a list of discrete values that correspond to gas consumption per function, with **Total** showing
gas cost incurred in all the functions called by the function, and **Self** showing the gas cost done by only the given function.

Observing a transaction's gas consumption provides useful insight of expected gas cost usage of a smart contract.
When developing a smart contract, you can run a local network and publish the package to the local network. Then create a transaction that calls
your published smart contract, and finally run the profiler on the transaction to see a breakdown of the gas cost.

##### Publish a Move package {/* {#publish-a-move-package} */}

One of the main uses of the `one_chain client` command is to publish smart contracts on the OneChain network. This example switches the current environment to the Devnet network, then builds, tests, and publishes one of the existing Move examples available in the OneChain repository: [sui/examples/move](https://github.com/one-chain-labs/onechain/tree/main/examples/move)

This example also makes use of `one_chain move` commands. To learn more about those commands, see [OneChain Move CLI](#onechain-move-cli).

1. Open a terminal or console to the root of your local OneChain repository and navigate to the `move_tutorial` example.
    ```sh
    $ cd examples/move/first_package
    ```
1. Switch to the Devnet network. This command uses an alias, so the `devnet` value might be different for you, depending on the alias name set in your configuration (use `one_chain client envs` for a list of your defined networks and their aliases).
    ```sh
    $ one_chain client switch --env devnet
    ```
1. Use `one_chain move build` to build the package. You must run this command at the same level as the package manifest file ([Move.toml](https://move-book.com/concepts/manifest.html)).
    ```sh
    $ one_chain move build
    ```
    The console responds with the status of the build.
    ```sh
    INCLUDING DEPENDENCY Sui
    INCLUDING DEPENDENCY MoveStdlib
    BUILDING first_package
    ```
1. Use `one_chain move test` to run the unit tests.
    ```sh
    $ one_chain move test
    ```
    The console responds with updates of its progress.
    ```sh
    INCLUDING DEPENDENCY Sui
    INCLUDING DEPENDENCY MoveStdlib
    BUILDING first_package
    Running Move unit tests
    [ PASS    ] 0x0::example::test_module_init
    [ PASS    ] 0x0::example::test_sword_transactions
    Test result: OK. Total tests: 2; passed: 2; failed: 0
     ```
1. Use the `one_chain client verify-bytecode-meter` to check if the module passes the bytecode meter.
    ```sh
    $ one_chain client verify-bytecode-meter
    ```
    The console responds with the maximum allowed values, as well as the amount the package uses.
    ```sh
    Running bytecode verifier for 1 modules
    ╭──────────────────────────────────╮
    │ Module will pass metering check! │
    ├────────┬────────────┬────────────┤
    │        │ Module     │ Function   │
    │ Max    │ 16000000   │ 16000000   │
    │ Used   │ 4565       │ 4565       │
    ╰────────┴────────────┴────────────╯
    ```
1. Use `one_chain client gas` to verify that the active address has a gas coin for paying gas. 
    ```sh
    $ one_chain client gas
    ```
    In the case of this example, the console responds with the information that the address is coinless.
    ```sh
    No gas coins are owned by this address
    ```
1. If you need coins, use `one_chain client faucet` (not available for Mainnet). For more information on getting gas tokens, see [Get OneChain Tokens](#request-a-oct-coin-from-faucet).
    ```sh
    $ one_chain client faucet
    ```
1. Use `one_chain client gas` to verify the current active address received the coins.
    ```sh
    $ one_chain client gas
    ```
    ```sh
    ╭────────────────────────────────────────────────────────────────────┬─────────────╮
    │ gasCoinId                                                          │ gasBalance  │
    ├────────────────────────────────────────────────────────────────────┼─────────────┤
    │ 0x01b2795ba5800c8f7cb7d7c56abe19e24c656ed6764f3ccc5e66da3de52402a8 │ 10000000000 │
    ╰────────────────────────────────────────────────────────────────────┴─────────────╯
    ```
1. Use `one_chain client publish` to publish the package, being sure to set an appropriate value for the `gas-budget` flag if you're using an older version of OneChain. The console responds with the details of the publish. You can use `one_chain client object <OBJECT-ID>` to check the details of any of the objects from the process.
    ```sh
    $ one_chain client publish --gas-budget 100000000 .
    ```
    ```sh
     Transaction Digest: ABPd7v8BxLkcyHvX8Jt1SbneQRwzE9WzcEoptT2RDNVF
    ╭──────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
    │ Transaction Data                                                                                             │
    ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
    │ Sender: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                                   │
    │ Gas Owner: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                                │
    │ Gas Budget: 5000000000 MIST                                                                                  │
    │ Gas Price: 1000 MIST                                                                                         │
    │ Gas Payment:                                                                                                 │
    │  ┌──                                                                                                         │
    │  │ ID: 0x01b2795ba5800c8f7cb7d7c56abe19e24c656ed6764f3ccc5e66da3de52402a8                                    │
    │  │ Version: 2                                                                                                │
    │  │ Digest: GZQwvpxLeTciVboEWeC8EZ2KYYU9o6XoBtW6LrA5Si1h                                                      │
    │  └──                                                                                                         │
    │                                                                                                              │
    │ Transaction Kind: Programmable                                                                               │
    │ ╭──────────────────────────────────────────────────────────────────────────────────────────────────────────╮ │
    │ │ Input Objects                                                                                            │ │
    │ ├──────────────────────────────────────────────────────────────────────────────────────────────────────────┤ │
    │ │ 0   Pure Arg: Type: address, Value: "0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea" │ │
    │ ╰──────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
    │ ╭─────────────────────────────────────────────────────────────────────────╮                                  │
    │ │ Commands                                                                │                                  │
    │ ├─────────────────────────────────────────────────────────────────────────┤                                  │
    │ │ 0  Publish:                                                             │                                  │
    │ │  ┌                                                                      │                                  │
    │ │  │ Dependencies:                                                        │                                  │
    │ │  │   0x0000000000000000000000000000000000000000000000000000000000000001 │                                  │
    │ │  │   0x0000000000000000000000000000000000000000000000000000000000000002 │                                  │
    │ │  └                                                                      │                                  │
    │ │                                                                         │                                  │
    │ │ 1  TransferObjects:                                                     │                                  │
    │ │  ┌                                                                      │                                  │
    │ │  │ Arguments:                                                           │                                  │
    │ │  │   Result 0                                                           │                                  │
    │ │  │ Address: Input  0                                                    │                                  │
    │ │  └                                                                      │                                  │
    │ ╰─────────────────────────────────────────────────────────────────────────╯                                  │
    │                                                                                                              │
    │ Signatures:                                                                                                  │
    │    x437h/JxDAba2zkx4a2kEfz6iaXQ08T7+inyP5YkbmlSB5K7IYasM6onckjYDB19FNM1ZNqXm1z13VyTmDHXCw==                  │
    │                                                                                                              │
    ╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
    ╭───────────────────────────────────────────────────────────────────────────────────────────────────╮
    │ Transaction Effects                                                                               │
    ├───────────────────────────────────────────────────────────────────────────────────────────────────┤
    │ Digest: ABPd7v8BxLkcyHvX8Jt1SbneQRwzE9WzcEoptT2RDNVF                                              │
    │ Status: Success                                                                                   │
    │ Executed Epoch: 0                                                                                 │
    │                                                                                                   │
    │ Created Objects:                                                                                  │
    │  ┌──                                                                                              │
    │  │ ID: 0x569828cc4e134ccccd7408def18b80af1465ac791fd4ef40483f6b16e2f00d95                         │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
    │  │ Version: 3                                                                                     │
    │  │ Digest: 4iD7ZhsFS9iFuszqxBSEL6xZdcnWG76WGgU4D5PH1PeL                                           │
    │  └──                                                                                              │
    │  ┌──                                                                                              │
    │  │ ID: 0xde670ae990c8f20fd53e9f597a0da056bdb634175176602658e9da2c2ec9cb93                         │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
    │  │ Version: 3                                                                                     │
    │  │ Digest: AV27tn7ePXhdDyDV9TCkSQZA3mkMei9DV63AmB4DEjGN                                           │
    │  └──                                                                                              │
    │  ┌──                                                                                              │
    │  │ ID: 0xe1d9d66b7a19b27ebda338a52593cd10e728f666f34ecd30a7cc2ad3fed186da                         │
    │  │ Owner: Immutable                                                                               │
    │  │ Version: 1                                                                                     │
    │  │ Digest: 4bzxMQgcSZoKzppNiRtQwAWDBvCgjr18gQi2H8Yk1tQZ                                           │
    │  └──                                                                                              │
    │ Mutated Objects:                                                                                  │
    │  ┌──                                                                                              │
    │  │ ID: 0x01b2795ba5800c8f7cb7d7c56abe19e24c656ed6764f3ccc5e66da3de52402a8                         │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
    │  │ Version: 3                                                                                     │
    │  │ Digest: 46rvdbXkw5qqsBYbUGChzgFatJAYPmarPmFHgRRJiiU9                                           │
    │  └──                                                                                              │
    │ Gas Object:                                                                                       │
    │  ┌──                                                                                              │
    │  │ ID: 0x01b2795ba5800c8f7cb7d7c56abe19e24c656ed6764f3ccc5e66da3de52402a8                         │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
    │  │ Version: 3                                                                                     │
    │  │ Digest: 46rvdbXkw5qqsBYbUGChzgFatJAYPmarPmFHgRRJiiU9                                           │
    │  └──                                                                                              │
    │ Gas Cost Summary:                                                                                 │
    │    Storage Cost: 9978800                                                                          │
    │    Computation Cost: 1000000                                                                      │
    │    Storage Rebate: 978120                                                                         │
    │    Non-refundable Storage Fee: 9880                                                               │
    │                                                                                                   │
    │ Transaction Dependencies:                                                                         │
    │    891Qjq6qDZ6SzAJiAg3CEaHobXrpDL5bAy2o45ZJPTuB                                                   │
    │    ESHcS3y3VCuaCVmWkKDx3EXX3icfPtj4bHhk86gaGWdo                                                   │
    ╰───────────────────────────────────────────────────────────────────────────────────────────────────╯
    ╭─────────────────────────────╮
    │ No transaction block events │
    ╰─────────────────────────────╯
    ╭────────────────────────────────────────────────────────────────────────────────────────────────────╮
    │ Object Changes                                                                                     │
    ├────────────────────────────────────────────────────────────────────────────────────────────────────┤
    │ Created Objects:                                                                                   │
    │  ┌──                                                                                               │
    │  │ ObjectID: 0x569828cc4e134ccccd7408def18b80af1465ac791fd4ef40483f6b16e2f00d95                    │
    │  │ Sender: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                      │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )   │
    │  │ ObjectType: 0xe1d9d66b7a19b27ebda338a52593cd10e728f666f34ecd30a7cc2ad3fed186da::example::Forge  │
    │  │ Version: 3                                                                                      │
    │  │ Digest: 4iD7ZhsFS9iFuszqxBSEL6xZdcnWG76WGgU4D5PH1PeL                                            │
    │  └──                                                                                               │
    │  ┌──                                                                                               │
    │  │ ObjectID: 0xde670ae990c8f20fd53e9f597a0da056bdb634175176602658e9da2c2ec9cb93                    │
    │  │ Sender: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                      │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )   │
    │  │ ObjectType: 0x2::package::UpgradeCap                                                            │
    │  │ Version: 3                                                                                      │
    │  │ Digest: AV27tn7ePXhdDyDV9TCkSQZA3mkMei9DV63AmB4DEjGN                                            │
    │  └──                                                                                               │
    │ Mutated Objects:                                                                                   │
    │  ┌──                                                                                               │
    │  │ ObjectID: 0x01b2795ba5800c8f7cb7d7c56abe19e24c656ed6764f3ccc5e66da3de52402a8                    │
    │  │ Sender: 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea                      │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )   │
    │  │ ObjectType: 0x2::coin::Coin<0x2::oct::OCT>                                                      │
    │  │ Version: 3                                                                                      │
    │  │ Digest: 46rvdbXkw5qqsBYbUGChzgFatJAYPmarPmFHgRRJiiU9                                            │
    │  └──                                                                                               │
    │ Published Objects:                                                                                 │
    │  ┌──                                                                                               │
    │  │ PackageID: 0xe1d9d66b7a19b27ebda338a52593cd10e728f666f34ecd30a7cc2ad3fed186da                   │
    │  │ Version: 1                                                                                      │
    │  │ Digest: 4bzxMQgcSZoKzppNiRtQwAWDBvCgjr18gQi2H8Yk1tQZ                                            │
    │  │ Modules: example                                                                                │
    │  └──                                                                                               │
    ╰────────────────────────────────────────────────────────────────────────────────────────────────────╯
    ╭───────────────────────────────────────────────────────────────────────────────────────────────────╮
    │ Balance Changes                                                                                   │
    ├───────────────────────────────────────────────────────────────────────────────────────────────────┤
    │  ┌──                                                                                              │
    │  │ Owner: Account Address ( 0x0fe375fff0ee40d20c54a7f2478b9b5c7eaa3625b7611f9661ec5faefb4a6fea )  │
    │  │ CoinType: 0x2::oct::OCT                                                                        │
    │  │ Amount: -10000680                                                                              │
    │  └──                                                                                              │
    ╰───────────────────────────────────────────────────────────────────────────────────────────────────╯
    ```

##### Help {/* {#help} */}

Each command has its own help section. For example, `one_chain client call --help` displays the following prompt:

```sh
Call Move function

Usage: one_chain client call [OPTIONS] --package <PACKAGE> --module <MODULE> --function <FUNCTION>

Options:
      --package <PACKAGE>               Object ID of the package, which contains the module
      --module <MODULE>                 The name of the module in the package
      --function <FUNCTION>             Function name in module
      --type-args <TYPE_ARGS>...        Type arguments to the generic function being called. All must be specified, or the call will fail
      --args <ARGS>...                  Simplified ordered args like in the function syntax ObjectIDs, Addresses must be hex strings
      --gas <GAS>                       ID of the gas object for gas payment. If not provided, a gas object with at least gas_budget value will be selected
      --gas-budget <GAS_BUDGET>         An optional gas budget for this transaction (in MIST). If gas budget is not provided, the tool will first perform a dry
                                        run to estimate the gas cost, and then it will execute the transaction. Please note that this incurs a small cost in
                                        performance due to the additional dry run call
      --dry-run                         Perform a dry run of the transaction, without executing it
      --dev-inspect                     Perform a dev inspect
      --serialize-unsigned-transaction  Instead of executing the transaction, serialize the bcs bytes of the unsigned transaction data (TransactionData) using
                                        base64 encoding, and print out the string <TX_BYTES>. The string can be used to execute transaction with `one_chain client  
                                        execute-signed-tx --tx-bytes <TX_BYTES>`
      --serialize-signed-transaction    Instead of executing the transaction, serialize the bcs bytes of the signed transaction data (SenderSignedData) using
                                        base64 encoding, and print out the string <SIGNED_TX_BYTES>. The string can be used to execute transaction with `one_chain
                                        client execute-combined-signed-tx --signed-tx-bytes <SIGNED_TX_BYTES>`
      --json                            Return command outputs in json format
  -h, --help                            Print help
  -V, --version                         Print version
```


#### OneChain Client PTB CLI {/* {#onechain-client-ptb-cli} */}


The `client ptb` command allows you to specify the transactions for execution in a programmable transaction block (PTB) directly from your CLI or through bash scripts.

:::warning

The examples in this document were tested using a `bash` shell environment. Your experience might vary depending on how your shell interprets the input values (for example, zsh requires quotes around passed values in brackets: "[]"; whereas bash accepts them without quotes). On Windows, you might need to add even more quotes around arguments passed (for example, `--assign "forge @<FORGE-ID>"`).

:::

##### Commands {/* {#commands-1} */}

The following list itemizes all the available args for the `one_chain client ptb` command. Use the `--help` for a long help version that includes some examples on how to use this command.

```
Build, preview, and execute programmable transaction blocks. Depending on your shell, you might have to use quotes around arrays or other passed values. Use --help to see examples for how to use the core functionality of this
command.

Usage: one_chain client ptb [OPTIONS]

Options:
      --assign <NAME> <VALUE>
          Assign a value to a variable name to use later in the PTB.
           If only a name is supplied, the result of the last transaction is bound to that name.
           If a name and value are supplied, then the name is bound to that value.

          Examples:
           --assign MYVAR 100
           --assign X [100,5000]
           --split-coins gas [1000, 5000, 75000]
           --assign new_coins # bound new_coins to the result of previous transaction

      --dry-run
          Perform a dry run of the PTB instead of executing it.

      --gas-coin <ID>
          The object ID of the gas coin to use. If not specified, it will try to use the first gas coin that it finds that has at least the requested gas-budget balance.

      --gas-budget <MIST>
          An optional gas budget for this PTB (in MIST). If gas budget is not provided, the tool will first perform a dry run to estimate the gas cost, and then it will execute the transaction. Please note that this incurs a small
          cost in performance due to the additional dry run call.

      --make-move-vec <TYPE> <[VALUES]>
          Given n-values of the same type, it constructs a vector. For non objects or an empty vector, the type tag must be specified.

          Examples:
           --make-move-vec <u64> []
           --make-move-vec <u64> [1, 2, 3, 4]
           --make-move-vec <std::option::Option<u64>> [none,none]
           --make-move-vec <sui::coin::Coin<sui::oct::OCT>> [gas]

      --merge-coins <INTO_COIN> <[COIN OBJECTS]>
          Merge N coins into the provided coin.

          Examples:
           --merge-coins @coin_object_id [@coin_obj_id1, @coin_obj_id2]

      --move-call <PACKAGE::MODULE::FUNCTION> <TYPE_ARGS> <FUNCTION_ARGS>
          Make a move call to a function.

          Examples:
           --move-call std::option::is_none <u64> none
           --assign a none
           --move-call std::option::is_none <u64> a

      --split-coins <COIN> <[AMOUNT]>
          Split the coin into N coins as per the given array of amounts.

          Examples:
           --split-coins gas [1000, 5000, 75000]
           --assign new_coins # bounds the result of split-coins command to variable new_coins
           --split-coins @coin_object_id [100]

      --transfer-objects <[OBJECTS]> <TO>
          Transfer objects to the specified address.

          Examples:
           --transfer-objects [obj1, obj2, obj3] @address

           --split-coins gas [1000, 5000, 75000]
           --assign new_coins # bound new_coins to result of split-coins to use next
           --transfer-objects [new_coins.0, new_coins.1, new_coins.2] @to_address

      --publish <MOVE_PACKAGE_PATH>
          Publish the Move package. It takes as input the folder where the package exists.

          Examples:
           --move-call sui::tx_context::sender
           --assign sender
           --publish "."
           --assign upgrade_cap
           --transfer-objects "[upgrade_cap]" sender

      --upgrade <MOVE_PACKAGE_PATH>
          Upgrade the move package. It takes as input the folder where the package exists.

      --preview
          Preview the list of PTB transactions instead of executing them.

      --serialize-unsigned-transaction
          Instead of executing the transaction, serialize the bcs bytes of the unsigned transaction data using base64 encoding.

      --serialize-signed-transaction
          Instead of executing the transaction, serialize the bcs bytes of the signed transaction data using base64 encoding.

      --summary
          Show only a short summary (digest, execution status, gas cost). Do not use this flag when you need all the transaction data and the execution effects.

      --warn-shadows
          Enable shadow warning when the same variable name is declared multiple times. Off by default.

      --json
          Return command outputs in json format.

  -h, --help
          Print help (see a summary with '-h')
```

##### Design philosophy and concepts {/* {#design-philosophy-and-concepts} */}

The main philosophy behind the CLI PTB support is to enable a user to build and execute a PTB from the command line. Bash scripts can be used to construct and execute the PTB just as you would do from the command line, providing great flexibility when it comes to automating different tasks.

Besides using existing traditional PTB related concepts, we introduce a few new and important concepts for this command.

:::warning

All the following examples were tested using a `bash` shell environment and your experience may vary depending on how your shell interprets the input values (e.g., zsh requires to pass values in brackets by adding quotes around it: "[]"; bash accepts them without quotes).

:::

###### Types {/* {#types} */}

Sometimes, CLI PTBs require that you specify the type of a value or variable. For instance, in the following example you must provide the `<u64>` type when calling the `0x1::option::is_none` function.

```sh
$ one_chain client ptb \
--assign my_variable none \
--move-call 0x1::option::is_none "<u64>" my_variable \
--gas-budget 50000000
```

To pass in multiple types, delimit them with a comma:

```sh
...
--move-call package::module::function "<u64,u8,u256>" \
...
```

###### Strings {/* {#strings} */}

CLI PTBs support string literals as inputs, which will be encoded as pure values that can be used as inputs to `vector<u8>`, `std::ascii::String` and `std::string::String` parameters. The following example previews a transaction block that passes the string `"Hello, world"` to a function `m::f` in a package `$PKG` (its ID is held in an environment variable).

```sh
$ one_chain client ptb --move-call "$PKG::m::f" '"Hello, world"' --gas-budget 10000000 --preview
``` 

:::warning

Double-quoted string literals tend to also be valid syntax for shells (like `bash`), so when inputting PTBs on the command-line, remember to wrap the entire string in single-quotes so that its double-quotes are interpreted literally, as in the previous example.

:::

###### Addresses and Object IDs {/* {#addresses-and-object-ids} */}

You can pass literal addresses and objects IDs by prefixing them with '@'. This is needed to distinguish a hexadecimal value from an address in some situations. 

For addresses that are in your local wallet, you can use their alias instead (passing them without '@', for example, --transfer-objects my_alias).

Here are some examples for `transfer-objects` and `gas-coin`:

```sh
$ one_chain client ptb --transfer-objects "[ARRAY_OF_OBJECTS]" @0x02a212de6a9dfa3a69e22387acfbafbb1a9e591bd9d636e7895dcfc8de05f331 --gas-coin @0x00002819ee07a66e53800495ccf5eeade8a02054a2e0827546c70e4b226f0495
```

###### Assign {/* {#assign} */}

Use the `--assign` argument to bind values to variables. There are two ways you can use it:

- assign a value to a variable
- assign a variable to the result of the previous command

Let's look at the first case where you assign a value to a variable. You want to check if some variable's value is `none`. Call the `0x1::option::is_none` function from the Move standard library, and pass in the variable name:

```sh
$ one_chain client ptb \
--assign my_variable none \
--move-call 0x1::option::is_none "<u64>" my_variable \
--gas-budget 50000000
```

:::tip

CLI PTB uses name resolution for common packages like `sui`, `std`, `deepbook`, so you can use them directly instead of their addresses: `0x2`, `0x1`, or `0xdee9`.

:::

In the second case, if a previous command outputs some result, you can bound it to a variable for later access. Let's see an example where you want a new coin with 1000 MIST, which you can achieve by using the `split-coins` command. After you do that, you want to transfer the new coin to another address. Without the `--assign` argument, you couldn't instruct the CLI to transfer that new coin object as you would not have a way to refer to it.

```sh
$ one_chain client ptb \
--split-coins gas "[1000]" \
--assign coin \
--transfer-objects "[coin]" @recipient_address \
--gas-budget 50000000
```

:::tip

If you build a complex PTB, use the `--preview` flag to display the PTB transaction list instead of executing it.

:::

##### Examples {/* {#examples-1} */}

The following examples demonstrate how to use the `client ptb` command.

:::tip

When a PTB is executed, the output contains all the relevant information (transaction data, gas cost, effects, object changes, and so on). Use `--summary` to get a short summary when you do not need all the data. For complex PTBs, you can use `--preview` to display the PTB transaction list instead of executing it.

:::

###### Move call {/* {#move-call} */}

When needing to execute a Move call, use the `--move-call` transaction to call a specific function from a package. The CLI PTB supports name resolution for common packages like `sui`, `std`, `deepbook`, so you can use both `0x1::option::is_none` as well as `std::option::is_none` for passing the function name.

```sh
--assign A none
--move-call std::option::is_none "<u64>" A
```

To call a specific function from a specific package, you can use the following call:

```sh
--move-call PACKAGE_ADDR::MODULE::FUNCTION "<TYPE>" FUNC_ARG1 FUNC_ARG2 ...
```

###### Publish {/* {#publish} */}

Publishing a package is one of the most important commands you need when working with OneChain. While the CLI has a standalone `publish` command, PTBs also support publishing and upgrading packages. One main difference is that with `one_chain client ptb`, you must explicitly transfer the `UpgradeCap` object that is returned when creating a package, or destroy it with a call to [`make_immutable`](/concepts/sui-move-concepts/packages.mdx). Here is an example on how to publish a Move project on chain using the `one_chain client ptb` command. It makes a call to the `sui::tx_context::sender` to acquire the sender and assigns the result of that call to the `sender` variable, and then calls the publish command. The result of `publish` is bounded to `upgrade_cap` variable, and then this object is transferred to the sender.

```sh
$ one_chain client ptb \
--move-call sui::tx_context::sender \
--assign sender \
--publish "." \
--assign upgrade_cap \
--transfer-objects "[upgrade_cap]" sender \
--gas-budget 100000000
```

###### Split, destroy, and merge coins {/* {#split-destroy-and-merge-coins} */}

The following example showcases how to split a gas coin into multiple coins, make a move call to destroy one or more of the new coins, and finally merge the coins that were not destroyed back into the gas coin. It also showcases how to use framework name resolution (for example, `sui::coin` instead of `0x2::coin`) and how to refer to different values in an array using the `.` syntax.

```sh
# Split off from gas
--split-coins gas "[0,1,2,3]"
--assign coins
--move-call sui::coin::destroy_zero<sui::oct::OCT> coins.0
# Can further split a split coin (and through variable bindings/result accesses)
--split-coins coins.1 "[0,0]"
--assign zcoins
# Destroy both new coins
--move-call sui::coin::destroy_zero<sui::oct::OCT> zcoins.0
--move-call sui::coin::destroy_zero<sui::oct::OCT> zcoins.1
# Can merge the split coins back
--merge-coins gas "[coins.1, coins.2, coins.3]"
--gas-budget 10000000
```

###### Transfer objects {/* {#transfer-objects} */}

This example creates three new coins from gas and transfers them to a different address.

```sh
--assign to_address @0x02a212de6a9dfa3a69e22387acfbafbb1a9e591bd9d636e7895dcfc8de05f331 \
--split-coins gas "[1,2,3]" \
--assign s \
--transfer-objects "[s.0, s.1, s.2]" to_address \
--gas-budget 10000000
```

:::info

You can also pass an alias (without the '@') instead of an address.

:::

##### Reserved words {/* {#reserved-words} */}

You cannot use the following words for variable names:

- `address`
- `bool`
- `vector`
- `some`
- `none`
- `gas`
- `u8`
- `u16`
- `u32`
- `u64`
- `u128`
- `u256`

##### JSON output {/* {#json-output-1} */}

Append the `--json` flag to commands to format responses in JSON instead of the more human-friendly default OneChain CLI output. This can be useful for extremely large datasets, for example, as those results can have a troublesome display on smaller screens. In these cases, the `--json` flag is useful.


#### OneChain Console CLI {/* {#onechain-console-cli} */}


The OneChain CLI `console` command provides command-level access to interact with the OneChain network by wrapping the OneChain Client CLI command in a shell-like functionality. This command spins up a new process and provides the user an environment for running all the available OneChain Client CLI commands. In addition, it also offers command history support.

##### Check OneChain CLI installation {/* {#check-onechain-cli-installation-1} */}

Before you can use the OneChain CLI, you must install it. To check if the CLI exists on your system, open a terminal or console and type the following command:

```sh
$ one_chain --version
```

If the terminal or console responds with a version number, you already have the OneChain CLI installed.

If the command is not found, follow the instructions in [Install OneChain](#update-cli) to get the OneChain CLI on your system.

##### Commands {/* {#commands-2} */}

For all available commands, consult the [OneChain Client CLI docs](#onechain-client-cli). To start the OneChain Console, type `one_chain console`, which displays some information similar to the following: 

```sh
🚀 ~ % one_chain console
  ___                ____ _           _
 / _ \ _ __   ___   / ___| |__   __ _(_)_ __
| | | | '_ \ / _ \ | |   | '_ \ / _` | | '_ \
| |_| | | | |  __/ | |___| | | | (_| | | | | |
 \___/|_| |_|\___|  \____|_| |_|\__,_|_|_| |_|
--- OneChain Console 1.14.0 ---

Managed addresses : 2
Active address: 0x3...235
Keystore Type : File
Keystore Path : Some("/Users/user/.one/one_config/one.keystore")
Active environment : testnet
RPC URL: https://rpc-testnet.onelabs.cc:443
[warn] Client/Server api version mismatch, client api version : 1.14.0, server api version : 1.13.0
Connecting to OneChain full node. API version 1.13.0

Available RPC methods: ["sui_devInspectTransactionBlock", "sui_dryRunTransactionBlock", "sui_executeTransactionBlock", 
"sui_getChainIdentifier", "sui_getCheckpoint", "sui_getCheckpoints", "sui_getEvents", "sui_getLatestCheckpointSequenceNumber", 
"sui_getLoadedChildObjects", "sui_getMoveFunctionArgTypes", "sui_getNormalizedMoveFunction", "sui_getNormalizedMoveModule", 
"sui_getNormalizedMoveModulesByPackage", "sui_getNormalizedMoveStruct", "sui_getObject", "sui_getProtocolConfig", 
"sui_getTotalTransactionBlocks", "sui_getTransactionBlock", "sui_multiGetObjects", "sui_multiGetTransactionBlocks", 
"sui_tryGetPastObject", "sui_tryMultiGetPastObjects", "suix_getAllBalances", "suix_getAllCoins", "suix_getBalance", 
"suix_getCoinMetadata", "suix_getCoins", "suix_getCommitteeInfo", "suix_getDynamicFieldObject", "suix_getDynamicFields", 
"suix_getLatestSuiSystemState", "suix_getOwnedObjects", "suix_getReferenceGasPrice", "suix_getStakes", "suix_getStakesByIds", 
"suix_getTotalSupply", "suix_getValidatorsApy", "suix_queryEvents", "suix_queryTransactionBlocks", "suix_resolveNameServiceAddress", 
"suix_resolveNameServiceNames", "suix_subscribeEvent", "suix_subscribeTransaction", "unsafe_batchTransaction", "unsafe_mergeCoins", 
"unsafe_moveCall", "unsafe_pay", "unsafe_payAllOct", "unsafe_payOct", "unsafe_publish", "unsafe_requestAddStake", 
"unsafe_requestWithdrawStake", "unsafe_splitCoin", "unsafe_splitCoinEqual", "unsafe_transferObject", "unsafe_transferOct"]

Welcome to the OneChain interactive console.

one>-$

```

#### OneChain Keytool CLI {/* {#onechain-keytool-cli} */}


The OneChain CLI `keytool` command provides several command-level access for the management and generation of addresses, as well as working with private keys, signatures, or zkLogin. For example, a user could export a private key from the OneChain Wallet and import it into the local OneChain CLI wallet using the `one_chain keytool import [...]` command.

##### Check OneChain CLI installation {/* {#check-onechain-cli-installation-2} */}

Before you can use the OneChain CLI, you must install it. To check if the CLI exists on your system, open a terminal or console and type the following command:

```sh
$ one_chain --version
```

If the terminal or console responds with a version number, you already have the OneChain CLI installed.

If the command is not found, follow the instructions in [Install OneChain](#update-cli) to get the OneChain CLI on your system.

##### Commands {/* {#commands-3} */}

```
Usage: one_chain keytool [OPTIONS] <COMMAND>

Commands:
  convert                           	Convert private key from legacy formats (e.g. Hex or Base64) to Bech32 encoded 33 byte `flag || private key` begins with `suiprivkey`
  decode-or-verify-tx                   Given a Base64 encoded transaction bytes, decode its components. If a signature is provided, verify the signature against the transaction 
  											and output the result.
  decode-multi-sig                  	Given a Base64 encoded MultiSig signature, decode its components. If tx_bytes is passed in, verify the multisig
  generate                          	Generate a new keypair with key scheme flag {ed25519 | secp256k1 | secp256r1} with optional derivation path, default to
                                        	m/44'/784'/0'/0'/0' for ed25519 or m/54'/784'/0'/0/0 for secp256k1 or m/74'/784'/0'/0/0 for secp256r1. Word length can be { word12 |
                                        	word15 | word18 | word21 | word24} default to word12 if not specified
  import                            	Add a new key to one.keystore using either the input mnemonic phrase or a private key (from the Wallet), the key scheme flag {ed25519 |
                                        	secp256k1 | secp256r1} and an optional derivation path, default to m/44'/784'/0'/0'/0' for ed25519 or m/54'/784'/0'/0/0 for secp256k1
                                        	or m/74'/784'/0'/0/0 for secp256r1. Supports mnemonic phrase of word length 12, 15, 18`, 21, 24
  list                              	List all keys by its OneChain address, Base64 encoded public key, key scheme name in one.keystore
  load-keypair                      	This reads the content at the provided file path. The accepted format can be [enum SuiKeyPair] (Base64 encoded of 33-byte `flag ||
                                        	privkey`) or `type AuthorityKeyPair` (Base64 encoded `privkey`). This prints out the account keypair as Base64 encoded `flag ||
                                        	privkey`, the network keypair, worker keypair, protocol keypair as Base64 encoded `privkey`
  multi-sig-address                 	To MultiSig OneChain Address. Pass in a list of all public keys `flag || pk` in Base64. See `keytool list` for example public keys
  multi-sig-combine-partial-sig     	Provides a list of participating signatures (`flag || sig || pk` encoded in Base64), threshold, a list of all public keys and a list of
                                        	their weights that define the MultiSig address. Returns a valid MultiSig signature and its sender address. The result can be used as
                                        	signature field for `one_chain client execute-signed-tx`. The sum of weights of all signatures must be >= the threshold
  multi-sig-combine-partial-sig-legacy
  show                              	Read the content at the provided file path. The accepted format can be [enum SuiKeyPair] (Base64 encoded of 33-byte `flag || privkey`)
                                        	or `type AuthorityKeyPair` (Base64 encoded `privkey`). It prints its Base64 encoded public key and the key scheme flag
  sign                              	Create signature using the private key for the given address in OneChain keystore. Any signature commits to a [struct IntentMessage]
                                        	consisting of the Base64 encoded of the BCS serialized transaction bytes itself and its intent. If intent is absent, default will be
                                        	used
  sign-kms                          	Creates a signature by leveraging AWS KMS. Pass in a key-id to leverage Amazon KMS to sign a message and the base64 pubkey. Generate
                                        	PubKey from pem using MystenLabs/base64pemkey Any signature commits to a [struct IntentMessage] consisting of the Base64 encoded of the
                                        	BCS serialized transaction bytes itself and its intent. If intent is absent, default will be used
  unpack                            	This takes [enum SuiKeyPair] of Base64 encoded of 33-byte `flag || privkey`). It outputs the keypair into a file at the current
                                        	directory where the address is the filename, and prints out its OneChain address, Base64 encoded public key, the key scheme, and the key
                                        	scheme flag
  zk-login-sign-and-execute-tx      	Given the max_epoch, generate an OAuth url, ask user to paste the redirect with id_token, call salt server, then call the prover
                                        	server, create a test transaction, use the ephemeral key to sign and execute it by assembling to a serialized zkLogin signature
  zk-login-enter-token              	A workaround to the above command because sometimes token pasting does not work. All the inputs required here are printed from the
                                        	command above
  zk-login-sig-verify               	Given a zkLogin signature, parse it if valid. If tx_bytes provided, it verifies the zkLogin signature based on provider and its latest
                                        	JWK fetched. Example request: one_chain keytool zk-login-sig-verify --sig $SERIALIZED_ZKLOGIN_SIG --tx-bytes $TX_BYTES --provider Google
                                        	--curr-epoch 10
  help                              	Print this message or the help of the given subcommand(s)

Options:
  	--keystore-path <KEYSTORE_PATH>
  	--json                       	Return command outputs in json format
  -h, --help                       	Print help
```

##### JSON output {/* {#json-output-2} */}

Append the `--json` flag to commands to format responses in JSON instead of the more human friendly default OneChain CLI output. This can be useful for extremely large datasets, for example, as those results can have a troublesome display on smaller screens. In these cases, the `--json` flag is useful. 

##### Examples {/* {#examples-2} */}

The following examples demonstrate some of the most often used commands. 

###### List the key pairs in the local wallet {/* {#list-the-key-pairs-in-the-local-wallet} */}

Use the `one_chain keytool list` command to output all the OneChain addresses that exist in the `~/.one/one_config/one.keystore` file in a readable format. 


```sh
$ one_chain keytool list
```
```sh
╭────────────────────────────────────────────────────────────────────────────────────────────╮
│ ╭─────────────────┬──────────────────────────────────────────────────────────────────────╮ │
│ │ suiAddress      │  0x3047f142a84297a42a65fb0a8c7a716d9d1b0bd0413d6bfa5ddfec45df175235  │ │
│ │ publicBase64Key │  AHsXwcxaWNaNtCIIszwu7V2G6HO8aNM1598w/8y0zI5q                        │ │
│ │ keyScheme       │  ed25519                                                             │ │
│ │ flag            │  0                                                                   │ │
│ │ peerId          │  7b17c1cc5a58d68db42208b33c2eed5d86e873bc68d335e7df30ffccb4cc8e6a    │ │
│ ╰─────────────────┴──────────────────────────────────────────────────────────────────────╯ │
│ ╭─────────────────┬──────────────────────────────────────────────────────────────────────╮ │
│ │ suiAddress      │  0x514692f08249c3e9957799ce29074695840422564bff85e424b56de462913e0d  │ │
│ │ publicBase64Key │  AKJCGi8R8TslhYdO2OHIjI6rbr+to1eR+vlOjigLY6SX                        │ │
│ │ keyScheme       │  ed25519                                                             │ │
│ │ flag            │  0                                                                   │ │
│ │ peerId          │  a2421a2f11f13b2585874ed8e1c88c8eab6ebfada35791faf94e8e280b63a497    │ │
│ ╰─────────────────┴──────────────────────────────────────────────────────────────────────╯ │
╰────────────────────────────────────────────────────────────────────────────────────────────╯
```

###### Generate a new key pair and store it in a file {/* {#generate-a-new-key-pair-and-store-it-in-a-file} */}

To generate a new key pair with the `ed25519` scheme, use the `one_chain keytool generate ed25519` command. For other schemes, see `one_chain keytool generate –help`. The key pair file is saved to the current directory with its filename being the address. The content of the file is a Base64 encoded string of 33-byte `flag || privkey`. 

```sh
$ one_chain keytool generate ed25519
```
```sh
╭─────────────────┬───────────────────────────────────────────────────────────────────────────────────╮
│ suiAddress      │  0x5d8aa70f17d9343813d3ba6a59ecf5e8a23ffb487938e860999a722989eaef25               │
│ publicBase64Key │  AKTAGf9iv0JqeLXXlsr4PUzBXb9VY8lK7xiZMS50GSu6                                     │
│ keyScheme       │  ed25519                                                                          │
│ flag            │  0                                                                                │
│ mnemonic        │  cushion price ability recall payment embody kid media rude mosquito chalk broom  │
│ peerId          │  a4c019ff62bf426a78b5d796caf83d4cc15dbf5563c94aef1899312e74192bba                 │
╰─────────────────┴───────────────────────────────────────────────────────────────────────────────────╯
```

###### Show the key pair data from a file {/* {#show-the-key-pair-data-from-a-file} */}

Use `one_chain keytool show [filename]` to show the key pair data that is stored in a file. For example, the previous command generated a file named `0x5d8aa70f17d9343813d3ba6a59ecf5e8a23ffb487938e860999a722989eaef25.key`. 

```sh
$ one_chain keytool show 0x5d8aa70f17d9343813d3ba6a59ecf5e8a23ffb487938e860999a722989eaef25.key
```
```sh
╭─────────────────┬──────────────────────────────────────────────────────────────────────╮
│ suiAddress      │  0x5d8aa70f17d9343813d3ba6a59ecf5e8a23ffb487938e860999a722989eaef25  │
│ publicBase64Key │  AC+AKTAGf9iv0JqeLXXlsr4PUzBXb9VY8lK7xiZMS50GSu6                     │
│ keyScheme       │  ed25519                                                             │
│ flag            │  0                                                                   │
│ peerId          │  a4c019ff62bf426a78b5d796caf83d4cc15dbf5563c94aef1899312e74192bba    │
╰─────────────────┴──────────────────────────────────────────────────────────────────────╯
```

###### Sign a transaction {/* {#sign-a-transaction} */}

```sh
$ one_chain keytool sign --data AAABACBRRpLwgknD6ZV3mc4pB0aVhAQiVkv/heQktW3kYpE+DQEBAQABAAAwR/FCqEKXpCpl+wqMenFtnRsL0EE9a/pd3+xF3xdSNQEaEUeErlBmGWxz3Bh+9BZh2mzayodzsri7xIZNDHRA3wIAAAAAAAAAILsR2d1FIZ5+ADDYZtJ2e9CWlpAxsGd4Y2rZrjlyTUF1MEfxQqhCl6QqZfsKjHpxbZ0bC9BBPWv6Xd/sRd8XUjXoAwAAAAAAAICWmAAAAAAAAA== --address 0x3047f142a84297a42a65fb0a8c7a716d9d1b0bd0413d6bfa5ddfec45df175235
```
```sh
╭──────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ suiAddress   │ 0x3047f142a84297a42a65fb0a8c7a716d9d1b0bd0413d6bfa5ddfec45df175235                                                                                               │
│ rawTxData    │ AAABACBRRpLwgknD6ZV3mc4pB0aVhAQiVkv/heQktW3kYpE+DQEBAQABAAAwR/FCqEKXpCpl+wqMenFtnRsL0EE9a/pd3+xF3xdSNQEaEUeErlBmGWxz3Bh+9BZh2mzayodzsri7xIZNDHRA3wIAAAAAAAAAILsR │
│              │ 2d1FIZ5+ADDYZtJ2e9CWlpAxsGd4Y2rZrjlyTUF1MEfxQqhCl6QqZfsKjHpxbZ0bC9BBPWv6Xd/sRd8XUjXoAwAAAAAAAICWmAAAAAAAAA==                                                     │
│ intent       │ ╭─────────┬─────╮                                                                                                                                                │
│              │ │ scope   │  0  │                                                                                                                                                │
│              │ │ version │  0  │                                                                                                                                                │
│              │ │ app_id  │  0  │                                                                                                                                                │
│              │ ╰─────────┴─────╯                                                                                                                                                │
│ rawIntentMsg │ AAAAAAABACBRRpLwgknD6ZV3mc4pB0aVhAQiVkv/heQktW3kYpE+DQEBAQABAAAwR/FCqEKXpCpl+wqMenFtnRsL0EE9a/pd3+xF3xdSNQEaEUeErlBmGWxz3Bh+9BZh2mzayodzsri7xIZNDHRA3wIAAAAAAAAA │
│              │ ILsR2d1FIZ5+ADDYZtJ2e9CWlpAxsGd4Y2rZrjlyTUF1MEfxQqhCl6QqZfsKjHpxbZ0bC9BBPWv6Xd/sRd8XUjXoAwAAAAAAAICWmAAAAAAAAA==                                                 │
│ digest       │ +B8Cbr16HfOVT50DoN/QF8HB0+oznm8KAYy8Rm+TQFo=                                                                                                                     │
│ suiSignature │ ANucBEl9TIE0uv+w965DvOjlfDUll7NUtIpJgRhPc3D3y3EtZ4cvaNbm8i5pc7TNIov/qI0FhzIYf2J6PbqoNQ57F8HMWljWjbQiCLM8Lu1dhuhzvGjTNeffMP/MtMyOag==                             │
╰──────────────┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
 ```

##### Help {/* {#help-1} */}

Each command has its own help section. For example `one_chain keytool sign –help` displays the following prompt:

```sh
$ one_chain keytool sign --help
```
```sh
Create signature using the private key for the given address in OneChain keystore. Any signature commits to a [struct IntentMessage] consisting of the Base64 encoded of the BCS serialized
transaction bytes itself and its intent. If intent is absent, default will be used

Usage: one_chain keytool sign [OPTIONS] --address <ADDRESS> --data <DATA>

Options:
  	--address <ADDRESS>  
  	--data <DATA>   	 
  	--json           	Return command outputs in json format
  	--intent <INTENT>    
  -h, --help           	Print help
```

#### OneChain Move CLI {/* {#onechain-move-cli} */}


The OneChain CLI `move` command provides several commands for working with Move source code. A typical usage of `one_chain move` is to compile and test the Move code, or to generate a new Move project by using `one_chain move new project_name`, which creates the needed directories and the `Move.toml` file.

##### Check OneChain CLI installation {/* {#check-onechain-cli-installation-3} */}

Before you can use the OneChain CLI, you must install it. To check if the CLI exists on your system, open a terminal or console and type the following command:

```sh
$ one_chain --version
```

If the terminal or console responds with a version number, you already have the OneChain CLI installed.

If the command is not found, follow the instructions in [Install OneChain](#update-cli) to get the OneChain CLI on your system.

##### Commands {/* {#commands-4} */}

Typing `one_chain move --help` into your terminal or console displays the following information on available commands.

```
Usage: one_chain move [OPTIONS] <COMMAND>

Commands:
  build
  coverage 	  Inspect test coverage for this package. A previous test run with the `--coverage` flag must have previously been run
  disassemble
  manage-package  Record addresses (Object IDs) for where this package is published on chain (this command sets variables in Move.lock)
  migrate         Migrate to Move 2024 for the package at `path`. If no path is provided defaults to current directory
  new             Create a new Move package with name `name` at `path`. If `path` is not provided the package will be created in the directory `name`
  test     	  Run Move unit tests in this package
  help            Print this message or the help of the given subcommand(s)

Options:
  -p, --path <PACKAGE_PATH>                 	Path to a package which the command should be run with respect to
  -d, --dev                                 	Compile in 'dev' mode. The 'dev-addresses' and 'dev-dependencies' fields will be used if this flag is set. This flag is useful for
                                            	development of packages that expose named addresses that are not set to a specific value
  	--test                                	Compile in 'test' mode. The 'dev-addresses' and 'dev-dependencies' fields will be used along with any code in the 'tests' directory
  	--doc                                 	Generate documentation for packages
  	--abi                                 	Generate ABIs for packages
  	--install-dir <INSTALL_DIR>           	Installation directory for compiled artifacts. Defaults to current directory
  	--force                               	Force recompilation of all packages
  	--fetch-deps-only                     	Only fetch dependency repos to MOVE_HOME
  	--skip-fetch-latest-git-deps          	Skip fetching latest git dependencies
  	--default-move-flavor <DEFAULT_FLAVOR>	Default flavor for move compilation, if not specified in the package's config
  	--default-move-edition <DEFAULT_EDITION>  Default edition for move compilation, if not specified in the package's config
  	--dependencies-are-root               	If set, dependency packages are treated as root packages. Notably, this will remove warning suppression in dependency packages
  -h, --help                                	Print help
  -V, --version                             	Print version
```

##### Examples {/* {#examples-3} */}

The following examples demonstrate some of the most often used commands.

###### Create a new Move project {/* {#create-a-new-move-project} */}

To create a new Move project that automatically adds the necessary dependencies in a `Move.toml` file, run `one_chain move new [<PROJECT-NAME>]`.

```sh
$ one_chain move new smart_contract_test
```
```sh
$ ls -l smart_contract_test
```
```sh
Move.toml
Sources
```
Display the contents of Move.toml file.

```sh
$ cat smart_contract_test/Move.toml
```

```sh
[package]
name = "smart_contract_test"
version = "0.0.1"

[dependencies]
Sui = { git = "https://github.com/one-chain-labs/onechain.git", subdir = "crates/sui-framework/packages/sui-framework", rev = "framework/testnet" }

[addresses]
smart_contract_test = "0x0"
```

###### Build a Move project {/* {#build-a-move-project} */}

Use `one_chain move build` at the root of your Move project to build the package.

```sh
$ one_chain move build
```
```sh
UPDATING GIT DEPENDENCY https://github.com/one-chain-labs/onechain.git
INCLUDING DEPENDENCY Sui
INCLUDING DEPENDENCY MoveStdlib
BUILDING smart_contract_test
```

###### Run tests in a Move project {/* {#run-tests-in-a-move-project} */}

Use `one_chain move test` to run the tests in a Move package.

```sh
$ one_chain move test
```
```sh
UPDATING GIT DEPENDENCY https://github.com/one-chain-labs/onechain.git
INCLUDING DEPENDENCY Sui
INCLUDING DEPENDENCY MoveStdlib
BUILDING smart_contract_test
Running Move unit tests
Test result: OK. Total tests: 0; passed: 0; failed: 0
```

###### Get test coverage for a module {/* {#get-test-coverage-for-a-module} */}


:::caution

This command currently only works on debug builds of the CLI.  Please build the CLI from source to use it.

:::


This example uses [`first_package`](https://github.com/one-chain-labs/onechain/tree/main/examples/move/first_package) Move package.

To get a summary of the test coverage, you must first run the `one_chain move test --coverage` command, and then the `one_chain move coverage summary --test` to get a summary of the test coverage in the example project.

```sh
$ one_chain move test --coverage
```
```sh
INCLUDING DEPENDENCY Sui
INCLUDING DEPENDENCY MoveStdlib
BUILDING first_package
Running Move unit tests
[ PASS    ] 0x0::example::test_module_init
[ PASS    ] 0x0::example::test_sword_transactions
Test result: OK. Total tests: 2; passed: 2; failed: 0

$ one_chain move coverage summary --test
+-------------------------+
| Move Coverage Summary   |
+-------------------------+
Module 0000000000000000000000000000000000000000000000000000000000000000::example
>>> % Module coverage: 92.81
+-------------------------+
| % Move Coverage: 92.81  |
+-------------------------+
```

##### Help {/* {#help-2} */}

Each command has its own help section. For example `one_chain move build --help` displays the following prompt:

```sh
$ one_chain move build --help
```
```sh
Usage: one_chain move build [OPTIONS]

Options:
  -p, --path <PACKAGE_PATH>                     Path to a package which the command should be run with respect to
      --with-unpublished-dependencies           Include the contents of packages in dependencies that haven't been published (only relevant when dumping
                                                bytecode as base64)
      --dump-bytecode-as-base64                 Whether we are printing in base64
  -d, --dev                                     Compile in 'dev' mode. The 'dev-addresses' and 'dev-dependencies' fields will be used if this flag is set. This
                                                flag is useful for development of packages that expose named addresses that are not set to a specific value
      --ignore-chain                            Don't specialize the package to the active chain when dumping bytecode as Base64. This allows building to
                                                proceed without a network connection or active environment, but it will not be able to automatically determine
                                                the addresses of its dependencies
      --generate-struct-layouts                 If true, generate struct layout schemas for all struct types passed into `entry` functions declared by modules
                                                in this package These layout schemas can be consumed by clients (e.g., the TypeScript SDK) to enable
                                                serialization/deserialization of transaction arguments and events
      --test                                    Compile in 'test' mode. The 'dev-addresses' and 'dev-dependencies' fields will be used along with any code in
                                                the 'tests' directory
      --doc                                     Generate documentation for packages
      --install-dir <INSTALL_DIR>               Installation directory for compiled artifacts. Defaults to current directory
      --force                                   Force recompilation of all packages
      --fetch-deps-only                         Only fetch dependency repos to MOVE_HOME
      --skip-fetch-latest-git-deps              Skip fetching latest git dependencies
      --default-move-flavor <DEFAULT_FLAVOR>    Default flavor for move compilation, if not specified in the package's config
      --default-move-edition <DEFAULT_EDITION>  Default edition for move compilation, if not specified in the package's config
      --dependencies-are-root                   If set, dependency packages are treated as root packages. Notably, this will remove warning suppression in
                                                dependency packages
      --silence-warnings                        If set, ignore any compiler warnings
      --warnings-are-errors                     If set, warnings become errors
      --json-errors                             If set, reports errors at JSON
      --no-lint                                 If `true`, disable linters
      --lint                                    If `true`, enables extra linters
  -h, --help                                    Print help
  -V, --version                                 Print version
```

#### OneChain Validator CLI {/* {#onechain-validator-cli} */}

The OneChain CLI `validator` command provides command-level access to validator features of the OneChain network.

##### Commands {/* {#commands-5} */}

Typing `one_chain validator --help` into your terminal or console displays the following information on available commands.

```sh
Usage: one_chain validator [OPTIONS] [COMMAND]

Commands:
  make-validator-info          	 
  become-candidate             	 
  join-committee               	 
  leave-committee              	 
  display-metadata             	 
  update-metadata              	 
  update-gas-price              	Update gas price that is used to calculate Reference Gas Price
  report-validator              	Report or un-report a validator
  serialize-payload-pop         	Serialize the payload that is used to generate Proof of Possession. This is useful to take the payload offline for an Authority protocol
                                    	keypair to sign
  display-gas-price-update-raw-txn  Print out the serialized data of a transaction that sets the gas price quote for a validator
  help                          	Print this message or the help of the given subcommand(s)

Options:
  	--client.config <CONFIG>  Sets the file storing the state of our user accounts (an empty one will be created if missing)
  	--json                	Return command outputs in json format
  -y, --yes                	 
  -h, --help                	Print help
```

##### Examples {/* {#examples-4} */}

The following examples demonstrate some of the most often used commands. 

###### Update gas price for next epoch {/* {#update-gas-price-for-next-epoch} */}

```sh
$ one_chain validator  update-gas-price 500
```


<details>
  <summary>
  Toggle output
  </summary>

```sh
----- Transaction Digest ----
A8z83EqjmgwRNFV6sme6A5tTTTQPjiLgiW76neyvhLud

----- Transaction Data ----
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Transaction Data                                                                                                                                                                                                                                                                                                                                                                                                                   	 │
├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Sender: 0xf...3d9                                                                                                                                                                                                                                                                                                                                                         	                                                         │
│ Gas Owner: 0xf...3d9                                                                                                                                                                                                                                                                                                                                                      	                                                         │
│ Gas Budget: 200000000 MIST                                                                                                                                                                                                                                                                                                                                                                                                         	 │
│ Gas Price: 1000 MIST                                                                                                                                                                                                                                                                                                                                                                                                               	 │
│ Gas Payment:                                                                                                                                                                                                                                                                                                                                                                                                                       	 │
│  ┌──                                                                                                                                                                                                                                                                                                                                                                                                                               	 │
│  │ ID: 0x8...19e                                                                                                                                                                                                                                                                                                                                                          	                                                         │
│  │ Version: 1                                                                                                                                                                                                                                                                                                                                                                                                                      	 │
│  │ Digest: 8UEiGYe3KL3S6JPs8uP2sbbx7sMCtzi8yJJ6SyTe9V1x                                                                                                                                                                                                                                                                                                                                                                            	 │
│  └──                                                                                                                                                                                                                                                                                                                                                                                                                               	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                    	 │
│ Transaction Kind : Programmable                                                                                                                                                                                                                                                                                                                                                                                                    	 │
│ Inputs: [Object(SharedObject { object_id: 0x0...005, initial_shared_version: SequenceNumber(1), mutable: true }), Object(ImmOrOwnedObject { object_id: 0x4...dbe, version: SequenceNumber(1), digest: o#82z9UUX9iD2Mq9zvciD56kmmDYqjF3iwaFadi3Mk16eJ }), Pure(SuiPureValue { value_type: Some(U64), value: "500" })]                                                                                                                   │
│ Commands: [                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
│   MoveCall(0x0...003::sui_system::request_set_gas_price(Input(0),Input(1),Input(2))),                                                                                                                                                                                                                                                                                     	                                                         │
│ ]                                                                                                                                                                                                                                                                                                                                                                                                                                  	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                    	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                    	 │
│ Signatures:                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
│	j2FE7GNkHm9+ey0zTQrgfaTXJgGu1vYWmivrVxbUfP56vIrxMFA4XxqEyw7Q8pM1FR+JDPgCsE1kgZRGH6TZDg==                                                                                                                                                                                                                                                                                                                                        	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                    	 │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
----- Transaction Effects ----
╭───────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Transaction Effects                                                                           	│
├───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Digest: A8z83EqjmgwRNFV6sme6A5tTTTQPjiLgiW76neyvhLud                                          	│
│ Status: Success                                                                               	│
│ Executed Epoch: 5                                                                             	│
│                                                                                               	│
│ Mutated Objects:                                                                              	│
│  ┌──                                                                                          	│
│  │ ID: 0x0...005                     	                                                            │
│  │ Owner: Shared                                                                              	│
│  │ Version: 16                                                                                	│
│  │ Digest: ER2L6MxrqKNAsaRd9pWdMwvLzXG3ocGQnytnP9s5QLeh                                       	│
│  └──                                                                                          	│
│  ┌──                                                                                          	│
│  │ ID: 0x4...dbe                     	                                                            │
│  │ Owner: Account Address ( 0xf45...3d9 )                                                         │
│  │ Version: 16                                                                                	│
│  │ Digest: 4yDkecsKPe8SnacWdECmq1yVDt7MzvpXCxbRGs74PGaB                                       	│
│  └──                                                                                          	│
│  ┌──                                                                                          	│
│  │ ID: 0x5...8d1                     	                                                            │
│  │ Owner: Object ID: ( 0x000...005 )   	                                                        │
│  │ Version: 16                                                                                	│
│  │ Digest: BBu5zHWWX7nnb1XcFu5VLVnKZEU6AqRRarDDjEeBtqWy                                       	│
│  └──                                                                                          	│
│  ┌──                                                                                          	│
│  │ ID: 0x8...19e                     	                                                            │
│  │ Owner: Account Address ( 0xf45...3d9 )                                                         │
│  │ Version: 16                                                                                	│
│  │ Digest: 4WQp6FYctutMFzf6f2EX68xut71AMubewJ6c7GxpzX7e                                       	│
│  └──                                                                                          	│
│                                                                                               	│
│ Shared Objects:                                                                               	│
│  ┌──                                                                                          	│
│  │ ID: 0x0...005                     	                                                            │ 
│  │ Version: 15                                                                                	│
│  │ Digest: 6vdobiuiDQpJguDxVbbMNW5ddRqEFkP67C3FWrAVYYuZ                                       	│
│  └──                                                                                          	│
│                                                                                               	│
│ Gas Object:                                                                                   	│
│  ┌──                                                                                          	│
│  │ ID: 0x8...19e                     	                                                            │
│  │ Owner: Account Address ( 0xf45...3d9 )                                                         │
│  │ Version: 16                                                                                	│
│  │ Digest: 4WQp6FYctutMFzf6f2EX68xut71AMubewJ6c7GxpzX7e                                       	│
│  └──                                                                                          	│
│                                                                                               	│
│ Gas Cost Summary:                                                                             	│
│	Storage Cost: 31479200                                                                     	    │
│	Computation Cost: 1000000                                                                  	    │
│	Storage Rebate: 0                                                                          	    │
│	Non-refundable Storage Fee: 0                                                              	    │
│                                                                                               	│
│ Transaction Dependencies:                                                                     	│
│	2gqHgPZbjTkDWM9GnVuWU5kT9z2SWN2ggwK3ryxf8aUX                                               	    │
│	EmW6DhJWRACNZAvupiTNVacZFLoZxbNJ88mrKVv9DeiJ                                               	    │
╰───────────────────────────────────────────────────────────────────────────────────────────────────╯
```

</details>


###### Set gas price for the next epoch {/* {#set-gas-price-for-the-next-epoch} */}

:::tip

Beginning with the OneChain [release](https://github.com/one-chain-labs/onechain/releases/tag/main), the `--gas-budget` option is no longer required for CLI commands.

:::

```sh
$ one_chain validator request_set_gas_price --args 0x5 \"42\" --gas-budget GAS-BUDGET-AMOUNT>
```

###### Display the validator information {/* {#display-the-validator-information} */}

```sh
$ one_chain validator display-metadata 0x3...de5
```


<details>
  <summary>
  Toggle output
  </summary>

```sh
0x3...de5's valdiator status: Active
SuiValidatorSummary {
	sui_address: 0x3...de5,
	protocol_pubkey_bytes: [
    	167,
    	93,
    	42,
    	177,
    	79,
    	244,
    	192,
    	168,
    	26,
    	242,
    	55,
    	119,
    	232,
    	131,
    	191,
    	112,
    	92,
    	219,
    	204,
    	109,
    	234,
    	107,
    	124,
    	116,
    	79,
    	200,
    	221,
    	159,
    	185,
    	142,
    	173,
    	161,
    	122,
    	214,
    	113,
    	183,
    	240,
    	124,
    	205,
    	8,
    	157,
    	110,
    	31,
    	85,
    	16,
    	106,
    	16,
    	34,
    	9,
    	254,
    	125,
    	36,
    	83,
    	125,
    	35,
    	231,
    	245,
    	203,
    	204,
    	43,
    	137,
    	70,
    	229,
    	201,
    	64,
    	157,
    	189,
    	203,
    	220,
    	222,
    	1,
    	121,
    	138,
    	139,
    	41,
    	108,
    	106,
    	57,
    	116,
    	212,
    	208,
    	249,
    	215,
    	18,
    	22,
    	237,
    	214,
    	179,
    	71,
    	192,
    	93,
    	89,
    	255,
    	51,
    	56,
    	158,
	],
	network_pubkey_bytes: [
    	118,
    	14,
    	165,
    	223,
    	145,
    	150,
    	130,
    	74,
    	212,
    	160,
    	218,
    	170,
    	134,
    	2,
    	206,
    	72,
    	228,
    	87,
    	35,
    	114,
    	40,
    	217,
    	206,
    	35,
    	29,
    	194,
    	81,
    	61,
    	186,
    	215,
    	56,
    	215,
	],
	worker_pubkey_bytes: [
    	84,
    	171,
    	204,
    	100,
    	81,
    	92,
    	16,
    	207,
    	151,
    	167,
    	70,
    	138,
    	104,
    	92,
    	100,
    	75,
    	53,
    	47,
    	212,
    	209,
    	92,
    	2,
    	109,
    	120,
    	66,
    	146,
    	180,
    	116,
    	144,
    	22,
    	139,
    	57,
	],
	proof_of_possession_bytes: [
    	137,
    	134,
    	236,
    	79,
    	232,
    	146,
    	206,
    	45,
    	136,
    	245,
    	8,
    	42,
    	114,
    	154,
    	128,
    	148,
    	60,
    	137,
    	214,
    	92,
    	177,
    	46,
    	118,
    	246,
    	37,
    	159,
    	183,
    	233,
    	122,
    	49,
    	121,
    	227,
    	136,
    	76,
    	48,
    	122,
    	119,
    	187,
    	194,
    	169,
    	114,
    	7,
    	16,
    	225,
    	104,
    	211,
    	100,
    	198,
	],
	name: "Staked",
	description: "The leading provider of staking infrastructure",
	image_url: "https://avatars.githubusercontent.com/u/38704373",
	project_url: "https://staked.us/",
	net_address: "/dns/sui-mainnet.prod-eks-eu-west-1.staked.cloud/tcp/8080/http",
	p2p_address: "/dns/sui-mainnet-udp.prod-eks-eu-west-1.staked.cloud/udp/8084",
	primary_address: "/dns/sui-mainnet-udp.prod-eks-eu-west-1.staked.cloud/udp/8081",
	worker_address: "/dns/sui-mainnet-udp.prod-eks-eu-west-1.staked.cloud/udp/8082",
	next_epoch_protocol_pubkey_bytes: None,
	next_epoch_proof_of_possession: None,
	next_epoch_network_pubkey_bytes: None,
	next_epoch_worker_pubkey_bytes: None,
	next_epoch_net_address: None,
	next_epoch_p2p_address: None,
	next_epoch_primary_address: None,
	next_epoch_worker_address: None,
	voting_power: 53,
	operation_cap_id: 0x4...217,
	gas_price: 1000,
	commission_rate: 1000,
	next_epoch_stake: 42223548570491465,
	next_epoch_gas_price: 1000,
	next_epoch_commission_rate: 1000,
	staking_pool_id: 0xc...932,
	staking_pool_activation_epoch: Some(
    	0,
	),
	staking_pool_deactivation_epoch: None,
	staking_pool_sui_balance: 42926894529549497,
	rewards_pool: 1047712965206377,
	pool_token_balance: 41704322845739375,
	pending_stake: 0,
	pending_total_sui_withdraw: 703345959058032,
	pending_pool_token_withdraw: 683314441220777,
	exchange_rates_id: 0x5...65d,
	exchange_rates_size: 231,
```
</details>

###### Report a bad / non-performant validator {/* {#report-a-bad--non-performant-validator} */}

```sh
$ one_chain validator report-validator  0xf...3d9
```


<details>
  <summary>
  Toggle output
  </summary>


```sh
----- Transaction Digest ----
8jVYrpuRBmdSLP37MsQGRqUqE3kE2m8XiSS4TG4aJwXf

----- Transaction Data ----
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Transaction Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Sender: 0xf...3d9                                                                                                                                                                                                                                                                                                                                                                                                                             	                                                         │
│ Gas Owner: 0xf...3d9                                                                                                                                                                                                                                                                                                                                                                                                                          	                                                         │
│ Gas Budget: 200000000 MIST                                                                                                                                                                                                                                                                                                                                                                                                                                                                             	 │
│ Gas Price: 1000 MIST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   	 │
│ Gas Payment:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           	 │
│  ┌──                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   	 │
│  │ ID: 0x8...19e                                                                                                                                                                                                                                                                                                                                                                                                                              	                                                         │
│  │ Version: 16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         	 │
│  │ Digest: 4WQp6FYctutMFzf6f2EX68xut71AMubewJ6c7GxpzX7e                                                                                                                                                                                                                                                                                                                                                                                                                                                	 │
│  └──                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
│ Transaction Kind : Programmable                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
│ Inputs: [Object(SharedObject { object_id: 0x0...005, initial_shared_version: SequenceNumber(1), mutable: true }), Object(ImmOrOwnedObject { object_id: 0x4...dbe, version: SequenceNumber(16), digest: o#4yDkecsKPe8SnacWdECmq1yVDt7MzvpXCxbRGs74PGaB }), Pure(SuiPureValue { value_type: Some(Address), value: "0xf...3d9" })]                                                                                                                                                                            │
│ Commands: [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	 │
│   MoveCall(0x0...003::sui_system::report_validator(Input(0),Input(1),Input(2))),                                                                                                                                                                                                                                                                                                                                                              	                                                         │
│ ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
│ Signatures:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	 │
│	7lJ9ezA1qjGk7nyFCESgLlg/tkVSy46dDkRgJzwgWP3qA+kAjJV8YVWFjJf2r6aLgWgCZCKnka9bkcp1V5jBAA==                                                                                                                                                                                                                                                                                                                                                                                                            	 │
│                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	 │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
----- Transaction Effects ----
╭──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Transaction Effects                                                                                                                                                                                                                                                                              	   │
├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Digest: 8jVYrpuRBmdSLP37MsQGRqUqE3kE2m8XiSS4TG4aJwXf                                                                                                                                                                                                                                             	   │
│ Status: Failure { error: "MoveAbort(MoveLocation { module: ModuleId { address: 0000000000000000000000000000000000000000000000000000000000000003, name: Identifier(\"sui_system_state_inner\") }, function: 16, instruction: 12, function_name: Some(\"report_validator_impl\") }, 3) in command 0" } │
│ Executed Epoch: 8                                                                                                                                                                                                                                                                                	   │
│                                                                                                                                                                                                                                                                                                  	   │
│ Mutated Objects:                                                                                                                                                                                                                                                                                 	   │
│  ┌──                                                                                                                                                                                                                                                                                             	   │
│  │ ID: 0x0...005                                                                                                                                                                                                                        	                                                           │
│  │ Owner: Shared                                                                                                                                                                                                                                                                                 	   │
│  │ Version: 25                                                                                                                                                                                                                                                                                   	   │
│  │ Digest: 5N5zyTyFCqAkyz44FGrpr6cYdXcwk4eUCHKzyAZqehMB                                                                                                                                                                                                                                          	   │
│  └──                                                                                                                                                                                                                                                                                             	   │
│  ┌──                                                                                                                                                                                                                                                                                             	   │
│  │ ID: 0x4...dbe                                                                                                                                                                                                                        	                                                           │
│  │ Owner: Account Address ( 0xf...3d9 )                                                                                                                                                                                                 	                                                           │
│  │ Version: 25                                                                                                                                                                                                                                                                                       │
│  │ Digest: HCEr5bcJhKo5jfRx2gsXxGSkpcq6tm8nFGSxxwoPpkNz                                                                                                                                                                                                                                          	   │
│  └──                                                                                                                                                                                                                                                                                             	   │
│  ┌──                                                                                                                                                                                                                                                                                             	   │
│  │ ID: 0x8...19e                                                                                                                                                                                                                        	                                                           │
│  │ Owner: Account Address ( 0xf...3d9 )                                                                                                                                                                                                 	                                                           │
│  │ Version: 25                                                                                                                                                                                                                                                                                   	   │
│  │ Digest: BTzMmVABwEKXoiLsTZ79Li97Eo6HPtNtWTvib8Eq1yrH                                                                                                                                                                                                                                          	   │
│  └──                                                                                                                                                                                                                                                                                             	   │
│                                                                                                                                                                                                                                                                                                  	   │
│ Shared Objects:                                                                                                                                                                                                                                                                                  	   │
│  ┌──                                                                                                                                                                                                                                                                                             	   │
│  │ ID: 0x0...005                                                                                                                                                                                                                        	                                                      	   │
│  │ Version: 24                                                                                                                                                                                                                                                                                   	   │
│  │ Digest: BiS4pKAX3KGXbJrk4oZijy6ggKHDZJd9qPUDWxLEoNR1                                                                                                                                                                                                                                          	   │
│  └──                                                                                                                                                                                                                                                                                             	   │
│                                                                                                                                                                                                                                                                                                  	   │
│ Gas Object:                                                                                                                                                                                                                                                                                      	   │
│  ┌──                                                                                                                                                                                                                                                                                             	   │
│  │ ID: 0x8...19e                                                                                                                                                                                                                        	                                                      	   │
│  │ Owner: Account Address ( 0xf...3d9 )                                                                                                                                                                                                 	                                                      	   │
│  │ Version: 25                                                                                                                                                                                                                                                                                   	   │
│  │ Digest: BTzMmVABwEKXoiLsTZ79Li97Eo6HPtNtWTvib8Eq1yrH                                                                                                                                                                                                                                          	   │
│  └──                                                                                                                                                                                                                                                                                             	   │
│                                                                                                                                                                                                                                                                                                  	   │
│ Gas Cost Summary:                                                                                                                                                                                                                                                                                	   │
│	Storage Cost: 4195200                                                                                                                                                                                                                                                                         	   │
│	Computation Cost: 1000000                                                                                                                                                                                                                                                                     	   │
│	Storage Rebate: 31164408                                                                                                                                                                                                                                                                      	   │
│	Non-refundable Storage Fee: 314792                                                                                                                                                                                                                                                            	   │
│                                                                                                                                                                                                                                                                                                  	   │
│ Transaction Dependencies:                                                                                                                                                                                                                                                                        	   │
│	2gqHgPZbjTkDWM9GnVuWU5kT9z2SWN2ggwK3ryxf8aUX                                                                                                                                                                                                                                                  	   │
│	A8z83EqjmgwRNFV6sme6A5tTTTQPjiLgiW76neyvhLud                                                                                                                                                                                                                                                  	   │
│	B8p4pVC5pzFQRVpZ73nZfAWMt7sL4iH4x4AbDviYWuzF                                                                                                                                                                                                                                                  	   │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
```

</details>


##### Help {/* {#help-3} */}

Each command has its own help section. For example `one_chain validator report-validator --help` will display the following prompt:

```sh
$ one_chain validator report-validator --help
```
```sh
Report or un-report a validator

Usage: one_chain validator report-validator [OPTIONS] <reportee-address>

Arguments:
  <reportee-address>  The OneChain Address of the validator is being reported or un-reported

Options:
  	--operation-cap-id <operation-cap-id>  Optional when sender is reporter validator itself and it holds the Cap object. Required when sender is not the reporter validator itself.
                                         	Validator's OperationCap ID can be found by using the `display-metadata` subcommand
  	--undo-report <undo-report>        	If true, undo an existing report [possible values: true, false]
  	--gas-budget <gas-budget>          	Gas budget for this transaction
  	--json                             	Return command outputs in json format
  -h, --help                             	Print help
```

#### OneChain CLI Cheat Sheet {/* {#onechain-cli-cheat-sheet} */}

The cheat sheet highlights common OneChain CLI commands.


##### Addresses & Aliases {/* {#addresses--aliases} */}

<table className="w-100">
	<thead>
		<tr>
			<td>Command</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td className="w-2/3">`one_chain client active-address`</td>
			<td className="w-1/3">Get the active address</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client addresses`</td>
			<td className="w-1/3">List the addresses, their aliases, and the active address</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client new-address ed25519`</td>
			<td className="w-1/3">Create a new address with ED25519 scheme</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client new-address ed25519 MY_ALIAS`</td>
			<td className="w-1/3">Create a new address with ED25519 scheme and alias</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client switch --address ADDRESS`</td>
			<td className="w-1/3">Make this the active address (accepts also an alias)</td>
		</tr>
		<tr> 	
			<td className="w-2/3">`one_chain keytool convert PRIVATE_KEY`</td>
			<td className="w-1/3">Convert private key in Hex or Base64 to new format (Bech32 encoded 33 byte flag || private key starting with "suiprivkey")</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain keytool generate ed25519`</td>
			<td className="w-1/3">Generate a new keypair with ED25519 scheme and save it to file</td>
		</tr>
		<tr> 	
      <td className="w-2/3">`one_chain keytool import INPUT KEY_SCHEME`</td>
			<td className="w-1/3">Add a new key to OneChain CLI Keystore using either the input mnemonic phrase or a Bech32 encoded 33-byte flag || privkey starting with "suiprivkey"</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain keytool update-alias OLD_ALIAS NEW_ALIAS`</td>
			<td className="w-1/3">Update the alias of an address</td>
		</tr>
	</tbody>
</table>

##### Faucet & Gas {/* {#faucet--gas} */}

<table className="w-100">
	<thead>
		<tr>
			<td>Command</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td className="w-2/3">`one_chain client faucet`</td>
			<td className="w-1/3">Get a Gas coin(OCT) from the faucet associated with the active network</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client faucet --address ADDRESS`</td>
			<td className="w-1/3">Get a Gas coin(OCT) for the address (accepts also an alias)</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client faucet --url CUSTOM_FAUCET_URL`</td>
			<td className="w-1/3">Get a Gas coin(OCT) from custom faucet</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client gas`</td>
			<td className="w-1/3">List the gas coins for the active address</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client gas ADDRESS`</td>
			<td className="w-1/3">List the gas coins for the given address (accepts also an alias)</td>
		</tr>
	</tbody>
</table>

##### Network Command Description {/* {#network-command-description} */}

<table className="w-100">
	<thead>
		<tr>
			<td>Command</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td className="w-2/3">`one_chain client active-env`</td>
			<td className="w-1/3">Get the active environment</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client envs`</td>
			<td className="w-1/3">List defined environments</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client new-env --rpc URL --alias ALIAS`</td>
			<td className="w-1/3">Create a new environment with URL and alias</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client switch --env ENV_ALIAS`</td>
			<td className="w-1/3">Switch to the given environment</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain genesis`</td>
			<td className="w-1/3">Bootstrap and initialize a new Sui network</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain start`</td>
			<td className="w-1/3">Start the local Sui network</td>
		</tr>
		<tr>
			<td className="w-2/3">`one-faucet`</td>
			<td className="w-1/3">Start a local faucet. Note this is a different binary</td>
		</tr>
	</tbody>
</table>

##### Create, Build, and Test a Move Project {/* {#create-build-and-test-a-move-project} */}

<table className="w-100">
	<thead>
		<tr>
			<td>Command</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td className="w-2/3">`one_chain move build`</td>
			<td className="w-1/3">Build the Move project in the current directory</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain move build --path PATH`</td>
			<td className="w-1/3">Build the Move project from the given path</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain move migrate PATH`</td>
			<td className="w-1/3">Migrate to Move 2024 for the package at provided path</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain move new PROJECT_NAME`</td>
			<td className="w-1/3">Create a new Move project in the given folder</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain move test`</td>
			<td className="w-1/3">Test the Move project in the current directory</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain move test --trace-execution`</td>
			<td className="w-1/3">Create an execution trace for the Move tests in the current directory. Use with the [Move Trace Debugger](https://marketplace.visualstudio.com/items?itemName=mysten.move-trace-debug) extension.</td>
		</tr>
	</tbody>
</table>

##### Executing Transactions {/* {#executing-transactions} */}

<table className="w-100">
	<thead>
		<tr>
			<td>Command</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td className="w-2/3">`one_chain client call \`<br/>&nbsp;&nbsp;`--package PACKAGE \`<br/>&nbsp;&nbsp;`--module MODULE \`<br/>&nbsp;&nbsp;`--function FUNCTION`</td>
			<td className="w-1/3">Call a Move package</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client merge-coin \`<br/>&nbsp;&nbsp;`--primary-coin COIN_ID \`<br/>&nbsp;&nbsp;`--coin-to-merge COIN_ID`</td>
			<td className="w-1/3">Merge two coins</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client split-coin \`<br/>&nbsp;&nbsp;`--coin-id COIN_ID \`<br/>&nbsp;&nbsp;`--amounts 1000`</td>
			<td className="w-1/3">Split a coin into two coins: one with 1000 MIST and the rest</td>
		</tr>
		<tr>
			<td className="w-2/3">
				`one_chain client pay-sui \`<br/>&nbsp;&nbsp;`--input-coins COIN_ID \`<br/>&nbsp;&nbsp;`--recipients ADDRESS \`<br/>&nbsp;&nbsp;`--amounts 100000000`
			</td>
			<td className="w-1/3">Transfer 0.1 OCT to an address and use the same coin for gas</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client transfer-sui \`<br/>&nbsp;&nbsp;`--sui-coin-object-id COIN_ID \`<br/>&nbsp;&nbsp;`--to ADDRESS`</td>
			<td className="w-1/3">Transfer OCT object to an address and use the same coin for gas</td>
		</tr>
	</tbody>
</table>

##### Programmable Transaction Blocks (PTBs) {/* {#programmable-transaction-blocks-(ptbs)} */}

<table className="w-100">
	<thead>
		<tr>
			<td>Command</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td className="w-2/3">`one_chain client ptb --move-call p::m::f "<type>" args`</td>
			<td className="w-1/3">Call a Move function from a package and module</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client ptb --make-move-vec "<u64>" "[1000,2000]"`</td>
			<td className="w-1/3">Make a Move vector with two elements of type u64</td>
		</tr>
		<tr>
			<td className="w-2/3">
				`one_chain client ptb \`<br/>&nbsp;&nbsp;`--split-coins gas "[1000]" \`<br/>&nbsp;&nbsp;`--assign new_coins \`<br/>&nbsp;&nbsp;`--transfer-objects
				"[new_coins]" ADDRESS`
			</td>
			<td className="w-1/3">Split a gas coin and transfer it to address</td>
		</tr>
		<tr>
			<td className="w-2/3">`one_chain client ptb --transfer-objects "[object_id]" ADDRESS`</td>
			<td className="w-1/3">
				Transfer an object to an address. Note that you can pass multiple objects in the array
			</td>
		</tr>
		<tr>
			<td className="w-2/3">
				`one_chain client ptb \`<br/>&nbsp;&nbsp;`--move-call sui::tx_context::sender \`<br/>&nbsp;&nbsp;`--assign sender \`<br/>&nbsp;&nbsp;`--publish "." \`<br/>&nbsp;&nbsp;`--assign
				upgrade_cap \`<br/>&nbsp;&nbsp;`--transfer-objects "[upgrade_cap]" sender`
			</td>
			<td className="w-1/3">Publish a Move package, and transfer the upgrade capability to sender</td>
		</tr>
	</tbody>
</table>

## OneChain SDKs

### Java API-Server Document v0.1 {/* {#java-api-server-document-v0-1} */}

#### Revise records {/* {#revise-records} */}
| **Version number** | **Revision date** | **Revision content** |
| --- | --- | --- |
| **v0.1** | **2025-04-01** | **version release** |

#### 1: Access preparation {/* {#1--access-preparation} */}
Before accessing, contact the technician to add the test merchant in the UAT environment, and then provide the materials according to the following form:

| Material Name | Material Description | Example |
| --- | --- | --- |
| Merchant server IP | The server IP that calls apiServer to add IP whitelist | 118.122.120.166 |
| Merchant call server public key | Used to verify the source of the merchant request (the merchant generates it by itself and saves the private key, and provides the public key to call the interface to verify the signature) | MIIBIjAN......AQAB |

#### 2: Api-Server domain name {/* {#2--api-server-domain-name} */}
| Environment | Address | Description |
| --- | --- | --- |
| dev | https://onechain-api.tpknp.com/app/api/ | Development environment for development and debugging code |
| uat | | Pre-issue environment for testing before going online |
| prod | | Formal environment, production address |

#### 3: Instructions for calling interface {/* {#3--instructions-for-calling-interface} */}

##### 3.1: Request/Response {/* {#3-1--request-response} */}

Information requests through the Web service will be completed by establishing an HTTP(s) connection. The request method is POST. The request content must be a JSON body. The HTTP(s) response will also be in JSON form.

##### 3.2: Interface parameter definition {/* {#3-2--interface-parameter-definition} */}
The field type to be defined will be explained according to the following definition:

String character: string [length].

The number between "[]" is the length of the string. It can be defined in two ways:

· String[14]: A string with a maximum length of "14" characters.

Required or optional fields are defined as follows:

· M: Required fields

· O: Optional fields

Possible values: [type]{length}: The number between "[]" is an acceptable value type, and the value between {} represents an acceptable length

##### 3.3: Request for public parts {/* {#3-3--request-for-public-parts} */}

After requesting the public header and obtaining jwt-token, the subsequent interface request should be equipped with access_token.

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| **access_token** | **String[100]** | **Access token** | **M** | **5e70972c...** |

##### 3.4: Respond to the public {/* {#3-4--respond-to-the-public} */}

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| code | String[16] | Response code | 000000 |
| msg | String[256] | Response Instructions | success |
| data | Object | Business Response Body | {} |
| success | Boolean | Is the request handled correctly | true |
| traceId | String[32] | Link id | 699241f7aafa7983 |
| systemTime | Long | Server Timestamp | 1707035254834 |


##### 3.5: Interface signature {/* {#3-5--interface-signature} */}

The merchant calling the interface needs to sign the request/callback to verify the legitimacy of the source.

###### 1) Generate public and private keys {/* {#1--generate-public-and-private-keys} */}

```bash
##Generate private key
openssl genrsa -out privateKey 2048 
##Generate public key 
openssl rsa -in privateKey -pubout -out publicKey 
##If the calling party is Java language, please convert the private key into pkcs8 format. The conversion command is as follows： 
openssl pkcs8 -topk8 -inform PEM -in privateKey -outform PEM -nocrypt -out pkcs8Privatekey
```

###### 2) Call the signature {/* {#2--call-the-signature} */}

For fields in the request, exclude <font style={{ color: '#DF2A3F' }}>merchantsSign</font> fields, and other non-empty fields, spliced ​​in dictionary order, using the private key generated in the previous step for signature.

Signature Algorithm: SHA256withRSA

Example of signature string: merchantId=1000000&timestamp=1741406605069

Notice:

1. Before signing the BigDecimal type, you need to remove the extra 0 after the decimal. For example: 100.20 is removed and 100.2 is 100.2.
2. Fields that are null do not participate in signatures

#### 4: api-server interface {/* {#4--api-server-interface} */}

##### 4.1: DID {/* {#4-1--did} */}

###### 4.1.1: Send verification code {/* {#4-1-1--send-verification-code} */}

<font style={{color:'#DF2A3F'}}>Note: The verification code currently sent is a huione site message</font>

**Interface address**: /did/sendCode

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| **timestamp** | **Long** | **Current timestamp, unit** **<font style={{ color: '#DF2A3F' }}>ms</font>** | **M** | **1743498522261** |
| **merchantSign** | **String[1024]** | **M** | **CaHXZC/SlR6VrlTwa9g5...** |
| **merchantId** | **String[30]** | **M** | **1000000** |
| mobile | String[20] | Mobile number that accepts SMS verification code | M | 182828666 |
| mobilePrefix | String[5] | Mobile number prefix | M | 855 |


**Request Example**: 

```json
{
  "merchantId": "1000000",
  "merchantSign": "CaHXZC/SlR6VrlTwa9g5...",
  "mobile": "182828666",
  "mobilePrefix": "+855",
  "timestamp": 1743498522261
}
```

**Response data result**: 

| **Field Type** | **Field Description** | **Example** |
| --- | --- | --- |
| String[64] | Site letter id | 1901826733104803841 |


**Response Example**: 

```json
{
  "code": "000000",
  "data": "1901826733104803841",
  "msg": "success",
  "success": true,
  "systemTime": 1742265802232,
  "traceId": "1742265800814AvBRSYMAac0ciTRWg"
}
```

###### 4.1.2: Mobile phone number authentication {/* {#4-1-2--mobile-phone-number-authentication} */}

**Interface address**: /did/authenticateSms

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| mobile | String[20] | Mobile number that accepts SMS verification code | M | 182828666 |
| mobilePrefix | String[5] | Mobile number prefix | M | 855 |
| smsCode | String[10] | Verification code sent by the site message | M | 123456 |
| code | String[30] | Site message id, returned by the interface that sends the verification code | M | 1901826733104803841 |


**Request Example**: 

```json
{
	"code": "1907263713418141697",
	"mobile": "182828666",
	"mobilePrefix": "+855",
	"smsCode": "000000"
}
```

**Response data result**: 

| **Field Type** | **Field Description** | **Example** |
| --- | --- | --- |
| String[64] | Authorization Code | Fww3fZCY4KVq9g |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "code": "Fww3fZCY4KVq9g"
  },
  "msg": "success",
  "success": true,
  "systemTime": 1742266313000,
  "traceId": "1742266312266LDLO2ccGoM41kkrit"
}
```

###### 4.1.3: Obtaining certification JWT-TOKEN {/* {#4-1-3--obtaining-certification-jwt-token} */}

**Interface address**: /did/getToken

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| code | String[20] | Authorization code | M | Fww3fZCY4KVq9g |
| nonce | String[50] | Random String | M | 1742266313000 |


**Request Example**: 

```json
{
	"code": "uaVO-P8yJwskVA",
	"nonce": "1"
}
```

**Response data result**: 

**data:**

| **Field name** | **Field type** | **Field description** | **Example** |
| --- | --- | --- | --- |
| accessToken | String[64] | Authorization code | eedecb58679... |
| accessTokenProfile | Object | Access token details, used to generate address for SDK | See the description below |
| anonymous | Boolean | Log in anonymously | false |
| avatarUrl | String[512] | avatar url | https://www.huione.com/202209/20/20220920122759_b8893.jpg |
| did | String[64] | User did | 4589717462235 |
| jwtToken | String[512] | jtw token | eyJhbGciOiJSUzI1N... |
| nickname | String[64] | Username | Zhang San |
| salt | String[64] | salt, used to generate address of sdk | false |
| settingPayPassword | Boolean | Whether to set a payment password | false |


**accessTokenProfile:**

| **Field name** | **Field type** | **Field description** | **Example** |
| --- | --- | --- | --- |
| aud | **String[64]** | **Recipient** |  |
| azp | **String[64]** | **licensor** |  |
| exp | **Long** | **Token Expiration time, unit: seconds** |  |
| iat | **Long** | Token Issuance time, unit: milliseconds |  |
| iss | **String[64]** | Issuer |  |
| jti | **String[64]** | **Token Unique Identity** |  |
| nbf | **Long** | **Token's effective time, unit: milliseconds** |  |
| nonce | **String[64]** | **Random Value** |  |
| sub | **String[64]** | **Theme** |  |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "accessToken": "eedecb5867994fb38305aa55f58837491742267152419",
    "accessTokenProfile": {
      "aud": "wallet-server",
      "azp": "provider",
      "exp": 1744859152,
      "iat": 1742267152381,
      "iss": "https://test.huionepay.com",
      "jti": "4ba81410d46542019017e88f290aeaad1742267152381",
      "nbf": 1742267152381,
      "nonce": "1742267055312",
      "sub": "1826899521471672321"
    },
    "anonymous": false,
    "avatarUrl": null,
    "did": "4589717462235",
    "jwtToken": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjEifQ.eyJhdWQiOiJ3YWxsZXQtc2VydmVyIiwic3ViIjoiMTgyNjg5OTUyMTQ3MTY3MjMyMSIsIm5iZiI6MTc0MjI2NzE1MjM4MSwiYXpwIjoicHJvdmlkZXIiLCJpc3MiOiJodHRwczovL3Rlc3QuaHVpb25lcGF5LmNvbSIsImV4cCI6MTc0NDg1OTE1MiwidXNlclByb2ZpbGVObyI6IjE5MDE1NDA1NzU5NDk2NjQyNTgiLCJpYXQiOjE3NDIyNjcxNTIzODEsIm5vbmNlIjoiMTc0MjI2NzA1NTMxMiIsImp0aSI6IjRiYTgxNDEwZDQ2NTQyMDE5MDE3ZTg4ZjI5MGFlYWFkMTc0MjI2NzE1MjM4MSJ9.Y7EdwqJj7lt8-276uI0zqGKZO_m8bh-EMmGcfCTo3aIwh5Oy9HSGPq4DnfkKwjSPMYLpAlzfT8MSHWTeq6NJa6Gb8YTUR9m4sX1Iq8tKKFh2THaOJj5FGaNRpQxCR74PhHEvccf4tE_u1BzfWm7KQN36MiRk7OBWIzCoCs5Fi0ih5sc9y-PHqN0E3zWi20t9elb4DLlCy0DLUsyLV2LG-Evvl8Mhjzo3jRbRX4I8ErTyjMAN_Buk5sTlP_Uf01THnXHIBPeqVPYq5piA6uucZP2gtM9tFCvqEbZct7bMRwOFh20BrLbxU2mDCeTsf-jlCBmhmnWkbxLHZBBl7yp19Q",
    "nickname": null,
    "salt": "1901540575882555394797177",
    "settingPayPassword": false
  },
  "msg": "success",
  "success": true,
  "systemTime": 1742267152472,
  "traceId": "1742267151477z0m0JyXbTXnwjvb8E"
}
```

###### 4.1.4: Obtain user information based on token {/* {#4-1-4--obtain-user-information-based-on-token} */}

**Interface address**: /did/getTokenUserProfile

**Interface parameters**: 

Just need the header to carry the token

**Request Example**: 

```json
{}
```

**Response data result**: 

**data:**

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| **accessToken** | **String[64]** | **Access token** | **723131b90d3748...** |
| **avatarUrl** | **String[512]** | **Avatar url** | **https://www.huione.com/202209/20/20220920122759_b8893.jpg** |
| **did** | **String[64]** | **User did** | **1827720282074849281** |
| **expireTime** | **String[512]** | **token expiration time** | **eyJhbGciOiJSUzI1N...** |
| **id** | **String[64]** | **User id** | **1905115439452069889** |
| **provider** | **String[64]** | **Provider** | **huione** |
| **userName** | **String[64]** | **Username** | **Zhang San** |
| **userNo** | **String[128]** | **UserNo** | **1827720282587602945** |
| **walletName** | **String[64]** | **Affiliated Merchant Name** | **false** |
| **walletType** | **Boolean** | **Merchant id** | **false** |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "accessToken": "723131b90d3748ccb7eac370767532ae1743562093866",
    "avatar": null,
    "did": "1827720282074849281",
    "expireTime": 1746154093,
    "id": 1905115439452069889,
    "provider": "huione",
    "userName": null,
    "userNo": "1827720282587602945",
    "walletName": "Test Merchant",
    "walletType": "1000000"
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743566574241,
  "traceId": "1743566573393PRxbLv02jao5Tz41G"
}
```

###### 4.1.5: Refresh token {/* {#4-1-5--refresh-token} */}

**Interface address**: /did/refreshJwtToken

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| nonce | String[50] | Random String | M | 1742266313000 |


**Request Example**: 

```json
{
	"nonce": "1"
}
```

**Response data result**: 

**See** 4.1.3: Obtaining Certification JWT-TOKEN

##### 4.2: Wallet related {/* {#4-2--wallet-related} */}

###### **4.2.1: Obtain information on the chain's supported currency and exchange rate with USD** {/* {#--4-2-1--obtain-information-on-the-chain's-supported-currency-and-exchange-rate-with-usd--} */}

**Interface address**: /wallet/queryChainCurrencyForList

**Interface parameters**: 

Just carry a token

**Request Example**: 

```json
{}
```

**Response data result**: 

**data:**

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| **chain** | **String[64]** | **Chapter Name** | **ETHEREUM** |
| **currencyList** | **`List<CurrencyInfo>`** | **Correlation information supported by the chain** | **See the instructions below** |


**currencyList**: 

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| **calculateDecimals** | Integer | **Currency Precision** | **6** |
| **coinType** | String[256] | **Currency Contract Address** | **See the instructions below** |
| **currency** | String[32] | **currency name** | **0x2::oct::OCT** |
| **currencyType** | Integer | **Currency Type** | **1:Fire Currency 2 Digital Currency** |
| **displayDecimals** | Integer | **display accuracy** | **1** |
| **exchangeRate** | BigDecimal | **Exchange Rate with USD** | **0.99** |
| **name** | String[128] | **Currency Name** |  |
| **pic** | String[1024] | **Coin Thumbnail** | **https://dpz1kj...** |
| **symbol** | String[128] | **Symbol** | **$** |


**Response Example**: 

```json
{
  "code": "000000",
  "data": [
    {
      "chain": "ETHEREUM",
      "currencyList": [
        {
          "calculateDecimals": 6,
          "coinType": "0x3a6Ae0a9D4281DC4a712ed4fF45aC09869fEc66a",
          "currency": "USDT",
          "currencyType": 2,
          "displayDecimals": 1,
          "exchangeRate": "0.99",
          "name": "",
          "pic": "https://dpz1kj0gjjwqh.cloudfront.net/20240528/254fee356c8673cc16f3047ad93d4739.png",
          "symbol": "ETH"
        }
      ]
    },
    {
      "chain": "BSC",
      "currencyList": [
        {
          "calculateDecimals": 9,
          "coinType": "0x9a52F245f976B8b99Fdaa0FdB7dEBCe3C97A8db2",
          "currency": "USDT",
          "currencyType": 2,
          "displayDecimals": 1,
          "exchangeRate": "0.99",
          "name": "",
          "pic": "https://dpz1kj0gjjwqh.cloudfront.net/20240528/254fee356c8673cc16f3047ad93d4739.png",
          "symbol": "BSC"
        }
      ]
    },
    {
      "chain": "TRON",
      "currencyList": [
        {
          "calculateDecimals": 6,
          "coinType": "TEdXFvFKdCHNYpgoLAdA73e2VGL45r8hR8",
          "currency": "USDT",
          "currencyType": 2,
          "displayDecimals": 1,
          "exchangeRate": "0.99",
          "name": "",
          "pic": "https://dpz1kj0gjjwqh.cloudfront.net/20240528/254fee356c8673cc16f3047ad93d4739.png",
          "symbol": "TRON"
        }
      ]
    },
    {
      "chain": "BITCOIN",
      "currencyList": []
    },
    {
      "chain": "ONECHAIN",
      "currencyList": [
        {
          "calculateDecimals": 6,
          "coinType": "0x500b939ebca8687537da8918e9d9be1c5d9d5a322abffd89a6215f77357677c2::usdh::USDH",
          "currency": "USDH",
          "currencyType": 2,
          "displayDecimals": 1,
          "exchangeRate": "1",
          "name": "",
          "pic": "https://dpz1kj0gjjwqh.cloudfront.net/20240715/fe75a508f5289d40202da9305b542599.png",
          "symbol": null
        },
        {
          "calculateDecimals": 6,
          "coinType": "0x3593438d7c3f20984250dcc575e48bb11331738f401010947cee37fa7105b5ec::usdt::USDT",
          "currency": "USDT",
          "currencyType": 2,
          "displayDecimals": 1,
          "exchangeRate": "0.99",
          "name": "",
          "pic": "https://dpz1kj0gjjwqh.cloudfront.net/20240528/254fee356c8673cc16f3047ad93d4739.png",
          "symbol": "$"
        },
        {
          "calculateDecimals": 9,
          "coinType": "0x2::oct::OCT",
          "currency": "USDT",
          "currencyType": 2,
          "displayDecimals": 1,
          "exchangeRate": "0.99",
          "name": "",
          "pic": "https://dpz1kj0gjjwqh.cloudfront.net/20240528/254fee356c8673cc16f3047ad93d4739.png",
          "symbol": "OCT"
        }
      ]
    }
  ],
  "msg": "success",
  "success": true,
  "systemTime": 1743843425724,
  "traceId": "1743843425633QZP1ai9Sso7JuR0v8"
}
```

****

###### **4.2.2: Query the basic information of the wallet** {/* {#--4-2-2--query-the-basic-information-of-the-wallet--} */}

**Interface address**: /wallet/queryUserWalletForList

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| **address** | **String[256]** | **Wallet address, just pass any one of them with did** | **M** | **0x85deaef8...** |
| **did** | **String[50]** | **did, just pass any one of them with the wallet address** | **O** | **1827720282074849281** |


**Request Example**: 

```json
{
	"address": "0x85deaef819e3a5ad7a4fa6ab1932f6c3d4213d14e2bac18c9df13b7948ace320",
	"did": ""
}
```

**Response data result**: 

**data:**

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| **account** | **String[64]** | **Account id** | **1000000** |
| **accountName** | **String[512]** | **Account Name** | **Zhang San** |
| **address** | **String[64]** | **Wallet Address** | **0x85deaef819e3...** |
| **aliasName** | **String[512]** | **Alias** |  |
| **chain** | **String[64]** | **Address chain** | **ONECHAIN** |
| **did** | **String[64]** | **did** | **1827720282074849281** |
| **userNo** | **String[64]** | **UserNO** | **1827720282587602945** |
| **walletType** | **Boolean** | **Merchant id** | **1000000** |


**Response Example**: 

```json
{
  "code": "000000",
  "data": [
    {
      "account": "1000000",
      "accountName": null,
      "address": "0x85deaef819e3a5ad7a4fa6ab1932f6c3d4213d14e2bac18c9df13b7948ace320",
      "aliasName": null,
      "chain": "ONECHAIN",
      "did": "1827720282074849281",
      "userNo": "1827720282587602945",
      "walletType": "1000000"
    }
  ],
  "msg": "success",
  "success": true,
  "systemTime": 1743568204781,
  "traceId": "174356820443544wuMfvX7hboWgSLw"
}
```

##### 4.3: Transaction related {/* {#4-3--transaction-related} */}

###### **4.3.1: Query the transaction records on the address chain** {/* {#--4-3-1--query-the-transaction-records-on-the-address-chain--} */}

**Interface address**: /tx/queryTx

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| **address** | **String[256]** | **Wallet Address** | **M** | **0x85deaef8...** |
| **endTime** | **Long** | **endTime** | **O** | **1743578977000** |
| **startTime** | **Long** | **Start Time** | **O** | **1743578977000** |
| **txType** | **`List<String>`** | **Transaction Type**<br/>**RECEIVE=Cash**<br/>**PAYMENT=Pay**<br/>**TRANSACTION=Transaction**<br/>**CONTRACT=Contract** | **O** | **["PAYMENT"]** |
| **txHash** | **String[256]** | **Transaction hash, which can be used to query a single record.** | **O** | **F2xwF82N...** |
| **currency** | **String[50]** | **Trading Currency** | **O** | **USDH** |
| **direction** | **String[50]** | Trading direction, IN/OUT, like swap type transactions, without direction, the results found may not be unique | **O** | **IN** |
| **chain** | **String[50]** | **Chapter Type**<br/>**ONE_CHAIN, TRON, ETH, BSC, BTC** | **M** | **1827720282074849281** |
| **pageIndex** | **Integer** | **1** | **M** | **1** |
| **pageSize** | **Integer** | **10** | **M** | **10** |


**Request Example**: 

```json
{
	"address": "0x328643c4e3cdd6aea9d0c031b08cde225b4b74fff013b1a778d1125cab848218",
	"chain": "ONE_CHAIN",
	"txHash":"F2xwF82NKkjEzSs1YeBwimGrzYxMmq3kSwgNki35WaPb",
	"direction":"",
	"currency":"",
	"endTime": null,
	"pageIndex": 1,
	"pageSize": 10,
	"startTime": null,
	"txType": []
}
```

**Response data result**: 

**data:**

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| **amount** | **String[64]** | Transaction amount, positive payment, negative payment | **10000** |
| **chainName** | **String[512]** | Chain Name | **OneChain** |
| **completeTime** | **String[64]** | Transaction Completion Time | **1743507013000** |
| **hash** | **String[512]** | Trading hash | **C3Mwx5XKbB...** |
| **receiver** | **String[64]** | Receive address | **0x559afcb...** |
| **scanUrl** | **String[64]** | View address on the chain | **https://hchain-explorer.tpkn...** |
| **sender** | **String[64]** | Send address | **0x60ce7d7...** |
| **status** | **Boolean** | Transaction status, 20: Success, 25: Failure | **20** |
| **symbol** | **String[10]** | **Trading Currency** | **USDH** |
| **txType** | **String[64]** | **Transaction type**: <br/>**RECEIVE: Payment**<br/>**PAYMENT: Payment**<br/>**TRANSACTION: Transaction**<br/>**CONTRACT: Contract Call** | **RECEIVE** |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "pageIndex": 1,
    "pageSize": 1,
    "rows": [
      {
        "amount": "10000",
        "chainName": "OneChain",
        "completeTime": 1743507013000,
        "hash": "C3Mwx5XKbBqddZ3j9qZhvtyaZME64J1mCdmEgqPrLCNm",
        "receiver": "0x559afcb3f2a91f464fd7fe415303fc7ecf956915de7eb5182293fd0d1f5d86a4",
        "scanUrl": "https://hchain-explorer.tpknp.com/#/transactionBlocksDetail?digest=C3Mwx5XKbBqddZ3j9qZhvtyaZME64J1mCdmEgqPrLCNm",
        "sender": "0x60ce7d7db55af12440959c9483570ec433db911180dcb8220a815e32183bd293",
        "status": 20,
        "symbol": "USDH",
        "txType": "RECEIVE"
      }
    ],
    "totalNum": 6
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743650039925,
  "traceId": "1743650039746J601VAHwPVzwqxQr0"
}
```

##### 4.4: Transfer-related {/* {#4-4--transfer-related} */}

###### 4.4.1: Create an Order {/* {#4-4-1--create-an-order} */}

**Interface address**: /transfer/createOrder

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| amount | String[64] | Transfer amount | M | 10 |
| coinType | String[64] | Transfer currency, fill in coinType, see 4.2.1 to return the result | M | OCT |
| fromAddress | String[30] | Send address | M | 0x85deaef819e3a5a... |
| remark | String[64] | Notes | O | remark |
| toAddress | String[10] | Receiver's address | M | 0x559afcb3... |


**Request Example**: 

```json
{
	"amount":10,
	"currency": "OCT",
	"fromAddress": "0x85deaef819e3a5ad7a4fa6ab1932f6c3d4213d14e2bac18c9df13b7948ace320",
	"remark": "",
	"toAddress": "0x559afcb3f2a91f464fd7fe415303fc7ecf956915de7eb5182293fd0d1f5d86a4"
}
```

**Response data result**: 

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| hash | String[64] | hash | 1901826733104803841 |
| rawTransaction | String | Content to be signed | |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "hash": "7pUb5ARr5akUdLBMUVorqviXJykS2bPT5qm1YAGVV6JC",
    "rawTransaction": "AAADAAgA4fUFAAAAAAEATsnWcUtWe0CGXZYGglwplmHclJHtbJ5Y1mMebIRHb0AFAAAAAAAAACB7AG/3dJcZroJuODSRMZVBTtsaePvr1LJukYYVvuFHRAAgVZr8s/KpH0ZP1/5BUwP8fs+VaRXefrUYIpP9DR9dhqQCAgEBAAEBAAABAQMAAAAAAQIAhd6u+Bnjpa16T6arGTL2w9QhPRTiusGMnfE7eUis4yABOhpaugU108s1vVVQoMlxo694BjqAcV4Jp5ni+UFwDFEEAAAAAAAAACDb6it7ZuzOcZc3jl6MYCxcW2A6kQQyx4/fn0VibmbvvT6Mtb4thvi5l6Gf21+USJ5w70PJ0jb9XAtV2zavXuhU6AMAAAAAAADY0TwAAAAAAAA="
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743735300943,
  "traceId": "1743735298074c0i0fb0qQ9yo0NYJ0"
}
```

###### 4.4.2: Execute transactions {/* {#4-4-2--execute-transactions} */}

**Interface address**: /transfer/sendTx

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| hash | String | order hash | M | |
| txBytes | String | Original transaction content | M | |
| userSig | String | User Signature | M | |

**Request Example**: 

```json
{
	"hash": "7pUb5ARr5akUdLBMUVorqviXJykS2bPT5qm1YAGVV6JC",
	"txBytes": "AAADAAgA4fUFAAAAAAEATsnWcUtWe0CGXZYGglwplmHclJHtbJ5Y1mMebIRHb0AFAAAAAAAAACB7AG/3dJcZroJuODSRMZVBTtsaePvr1LJukYYVvuFHRAAgVZr8s/KpH0ZP1/5BUwP8fs+VaRXefrUYIpP9DR9dhqQCAgEBAAEBAAABAQMAAAAAAQIAhd6u+Bnjpa16T6arGTL2w9QhPRTiusGMnfE7eUis4yABOhpaugU108s1vVVQoMlxo694BjqAcV4Jp5ni+UFwDFEEAAAAAAAAACDb6it7ZuzOcZc3jl6MYCxcW2A6kQQyx4/fn0VibmbvvT6Mtb4thvi5l6Gf21+USJ5w70PJ0jb9XAtV2zavXuhU6AMAAAAAAADY0TwAAAAAAAA=",
	"userSig": "BQNMNzE0OTY4NzI3NjM3OTk2NTg3MjUwODgxNjEzNDM0NTExMTI5MTc1MzUyMDI3ODE4NjkwMDQ2NTM1MTc0NTYzNzM2NTQxMTY3MDQ3MU0xNzYzMTk3OTgxNDIzNzU1MzUzNDIwNjA0MTQxMTM2OTEyMzM1MjI5OTk4MjE0NjE5ODUwNzg1Nzk0MzExNjg4OTUwNzAzNjczMjM5NQExAwJNMTY0MTc3NzAxNTE5Mzk5NTUyMjE0MzEwNjYzNDI5MzE1OTg4MDU2MzY3MTg1NTUzMDM0MjEyNzkyNTgyMTU2ODI4NTA2ODM3MTk5MTlMODkwMTM1MTAwMjEwODczMDEwNzU3NzM1MjY1Mzk3NTQ1NjkwNTcwMzk3OTQxMjkzNDU3MzkyNDM5NjA2OTczNzQ3NjcxNTk1OTI5MAJNMTM5NTIyNTE5NTkxNDg5OTI4NDQwNjA3NzQ2NjM3MjIzODg5NzczMDE4NDkwOTg4NTY4NTUxODg5MzU1NTQ1OTEyNTg3Mzg5ODM0ODBNMTkyMDEzODAwNDI4NzU2NjYxMDU3OTU3MTc3MzM5Mjg4NzEwNjI4NTIxOTE3ODIyNjE5MDEwNTM3OTMzOTg4MjM5ODA0Mzc1ODY4MjYCATEBMANNMTgyMDA1MDkyOTkxMjk4Mjg1MzEzOTA1NjgzMjAwODA3NTQ0OTM4NzMxODEzODU0Mjg5ODU5ODU4NDU5NjI2MjQ0MzUyOTE3MzcxMTZNMTYxMTg2MDkxNDEyMzkzMDI3MjY2NjE1NzYwMDgyNzE4Mjk5NjIxMjcyMjgyNjQzMjUwNDQ1MzkyMTQxNjI5NTM5MTk0ODQxMjAwNTgBMS95SnBjM01pT2lKb2RIUndjem92TDNSbGMzUXVhSFZwYjI1bGNHRjVMbU52YlNJcwEyZXlKaGJHY2lPaUpTVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0lzSW10cFpDSTZJakVpZlFMNDMyNjEwOTg3Njk0ODA5MTEyMzIzNjMyMTQ0NjE4OTI5MjA0MjQ4MjQ4NTU2MjkwNDI0MzQyMzUyNDUyNzUzMzMxMjI5MDY4MjM3OJQAAAAAAAAAYQAs7THNYomQw8DLmFV0qeaRsZ8GhrtXCNULXiQW6QjbhVPV54LurfSL/ougzIQ9HI2kh3XsjKRHt9Q4/Babq1AGJs4ydM4/8+5y/w9c+tlqYjp8CHekpEm7AvFyWiC/QwQ="
}
```

**Response data result**: 

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| hash | String | Trading hash | 7pUb5ARr... |
| status | String | **Order Status**<br/>**UN_PAY: To be paid**<br/>**RUNNING: Transfer**<br/>**SUCCESS: Transfer Success**<br/>**FAIL: Transfer failed**<br/>**CANCEL: Cancel**<br/>**TIMEOUT: Timeout** | SUCCESS |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "hash": "7pUb5ARr5akUdLBMUVorqviXJykS2bPT5qm1YAGVV6JC",
    "status": "SUCCESS"
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743735480267,
  "traceId": "1743735478463VUqDU32Tu5KSqNvWk"
}
```

###### 4.4.3: Pagination query {/* {#4-4-3--pagination-query} */}

**Interface address**: /transfer/pageList

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| beginTime | Long | Transaction Start Time | O | |
| completeBeginTime | Long | Transaction Completion Start Time | O | |
| completeEndTime | Long | Transaction Completion End Time | O | |
| currency | String | Currency | O | |
| endTime | Long | Transaction End Time | O | |
| hash | String | Trading hash | O | |
| pageIndex | Long | Current Page | M | 1 |
| pageSize | Long | Page Size | M | 10 |
| statusList | `List<String>` | Status List | O | |
| toAddress | String | Accounting Address | O | |


**Request Example**: 

```json
{
	"beginTime": null,
	"completeBeginTime": null,
	"completeEndTime": null,
	"currency": null,
	"endTime": null,
	"hash": null,
	"pageIndex": 1,
	"pageSize": 1,
	"statusList": null,
	"toAddress": null
}
```

**Response data result**: 

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| address | long | origin address | 0x85deaef819e3a... |
| addressName | String | Address Name | |
| amount | String | Transfer amount | 0.1 |
| completeTime | String | Completed Time | 1743735480000 |
| createTime | String | Created Time | 1743735299000 |
| currency | String | Currency | OCT |
| did | String | User did | 1827720282074849281 |
| hash | String | Trading hash | 7pUb5ARr5... |
| merchantId | String | Merchant ID | 1000000 |
| merchantName | String | Merchant Name | Test Merchant |
| nickName | String | User Nickname | |
| receiver | String | receiver name | 0x559afcb3f2a91f... |
| remark | String | Notes | |
| sender | String | sender name | 0x85deaef81... |
| status | String | Status | SUCCESS |
| toAddress | String | Accepted address | 0x559afcb3... |
| toAddressName | String | Address Name | |
| toDid | BigDecimal | Accounted user did | |
| toMerchantId | String | Merchant ID to which the account address belongs | |
| toMerchantName | Long | Merchant Name to the account address | |
| toNickName | Long | Accounting user nickname | |
| transferMethod | String | Transfer Method | ADDRESS |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "pageIndex": 1,
    "pageSize": 1,
    "rows": [
      {
        "address": "0x85deaef819e3a5ad7a4fa6ab1932f6c3d4213d14e2bac18c9df13b7948ace320",
        "addressName": null,
        "amount": "0.1",
        "completeTime": 1743735480000,
        "createTime": 1743735299000,
        "currency": "OCT",
        "did": "1827720282074849281",
        "hash": "7pUb5ARr5akUdLBMUVorqviXJykS2bPT5qm1YAGVV6JC",
        "merchantId": "1000000",
        "merchantName": "Test Merchant",
        "nickName": null,
        "receiver": "0x559afcb3f2a91f464fd7fe415303fc7ecf956915de7eb5182293fd0d1f5d86a4",
        "remark": "",
        "sender": "0x85deaef819e3a5ad7a4fa6ab1932f6c3d4213d14e2bac18c9df13b7948ace320",
        "status": "SUCCESS",
        "toAddress": "0x559afcb3f2a91f464fd7fe415303fc7ecf956915de7eb5182293fd0d1f5d86a4",
        "toAddressName": null,
        "toDid": null,
        "toMerchantId": null,
        "toMerchantName": null,
        "toNickName": null,
        "transferMethod": "ADDRESS"
      }
    ],
    "totalNum": 11
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743735636002,
  "traceId": "17437356356365ViQIBp87DhagvODV"
}
```

###### 4.4.4: Order Query {/* {#4-4-4--order-query} */}

**Interface address**: /transfer/queryOrder

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| hash | String[128] | Transaction hash | M | 7pUb5AR... |


**Request Example**: 

```json
{
	"hash": "7pUb5ARr5akUdLBMUVorqviXJykS2bPT5qm1YAGVV6JC"
}
```

**Response data result**: 

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| address | long | origin address | 0x85deaef819e3a... |
| addressName | String | Address Name | |
| amount | String | Transfer amount | 0.1 |
| completeTime | String | Completed Time | 1743735480000 |
| createTime | String | Created Time | 1743735299000 |
| currency | String | Currency | OCT |
| did | String | User did | 1827720282074849281 |
| hash | String | Trading hash | 7pUb5ARr5... |
| merchantId | String | Merchant ID | 1000000 |
| merchantName | String | Merchant Name | Test Merchant |
| nickName | String | User Nickname | |
| receiver | String | receiver name | 0x559afcb3f2a91f... |
| remark | String | Notes | |
| sender | String | sender name | 0x85deaef81... |
| status | String | Status | SUCCESS |
| toAddress | String | Accepted address | 0x559afcb3... |
| toAddressName | String | Address Name | |
| toDid | BigDecimal | Accounted user did | |
| toMerchantId | String | Merchant ID to which the account address belongs | |
| toMerchantName | Long | Merchant Name to the account address | |
| toNickName | Long | Accounting user nickname | |
| transferMethod | String | Transfer Method | ADDRESS |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "address": "0x85deaef819e3a5ad7a4fa6ab1932f6c3d4213d14e2bac18c9df13b7948ace320",
    "addressName": null,
    "amount": "0.1",
    "completeTime": 1743735480000,
    "createTime": 1743735299000,
    "currency": "OCT",
    "did": "1827720282074849281",
    "hash": "7pUb5ARr5akUdLBMUVorqviXJykS2bPT5qm1YAGVV6JC",
    "merchantId": "1000000",
    "merchantName": "Test Merchant",
    "nickName": null,
    "receiver": "0x559afcb3f2a91f464fd7fe415303fc7ecf956915de7eb5182293fd0d1f5d86a4",
    "remark": "",
    "sender": "0x85deaef819e3a5ad7a4fa6ab1932f6c3d4213d14e2bac18c9df13b7948ace320",
    "status": "SUCCESS",
    "toAddress": "0x559afcb3f2a91f464fd7fe415303fc7ecf956915de7eb5182293fd0d1f5d86a4",
    "toAddressName": null,
    "toDid": null,
    "toMerchantId": null,
    "toMerchantName": null,
    "toNickName": null,
    "transferMethod": "ADDRESS"
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743736544108,
  "traceId": "1743736535599UHO5IUkK9qq6NAhEN"
}
```

###### 4.4.5: Build payment transactions {/* {#4-4-5--build-payment-transactions} */}

**Interface address**: /transfer/buildSponsorTransaction

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| address | String[64] | Send address | M | 0x559afcb |
| onlyTransactionKind | String[64] | Is it a transaction built offline | M | false |
| rawTransaction | String[30] | Original transaction content | M | AAADA+HUjw... |
| gasBudget | String[64] | Maximum service fee usage value | O | 0.004 |


**Request Example**: 

```json
{
	"address": "0x559afcb3f2a91f464fd7fe415303fc7ecf956915de7eb5182293fd0d1f5d86a4",
	"onlyTransactionKind": false,
	"rawTransaction": "AAADAQDx+HUjw60Tgo9VxKfRLE4adJgTAxm1JH4Ixk2gJ4mFnSMAAAAAAAAAINKPdekL6DNYOESF6Wtj1nHmF1anXdI0GSVTtH5JTTH2AAiAlpgAAAAAAAAghd6u+Bnjpa16T6arGTL2w9QhPRTiusGMnfE7eUis4yACAgEAAAEBAQABAQMAAAAAAQIAVZr8s/KpH0ZP1/5BUwP8fs+VaRXefrUYIpP9DR9dhqQBBYdTMfThKWVNHFm27t2+dJy9x/36/rtQeQGPQj4xZSeybTMAAAAAACAu5cP4tWkdgO5auEDh+8wNLcZg2O/FtYcj+cfAQ0qh01Wa/LPyqR9GT9f+QVMD/H7PlWkV3n61GCKT/Q0fXYak6AMAAAAAAAAACT0AAAAAAAA=",
	"gasBudget":"0.004"
}
```

**Response data result**: 

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| expiration | Long | Transaction Expiration Time | 1743738124068 |
| hash | String | hash | 7uqD7ME2... |
| rawTransaction | String | Original transaction content | AAADAQDx+HUjw... |
| reservationId | Long | Receipt id, you need to bring this field to send a payment transaction | |
| sponsor | String | Fee sponsor address | 0x3e8cb5be2... |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "expiration": 1743738124068,
    "hash": "7uqD7ME25VV3GpM5S4vqPFsg27EcSAs4wGgmGoBDA7Jm",
    "rawTransaction": "AAADAQDx+HUjw60Tgo9VxKfRLE4adJgTAxm1JH4Ixk2gJ4mFnSMAAAAAAAAAINKPdekL6DNYOESF6Wtj1nHmF1anXdI0GSVTtH5JTTH2AAiAlpgAAAAAAAAghd6u+Bnjpa16T6arGTL2w9QhPRTiusGMnfE7eUis4yACAgEAAAEBAQABAQMAAAAAAQIAVZr8s/KpH0ZP1/5BUwP8fs+VaRXefrUYIpP9DR9dhqQBOjZVPhVDonIxQKaNzQDBtYmeZcUGxiMlCPPFWrl+vpoEAAAAAAAAACCnMs8g247NHxrVoZC8a62kZXpDK4Xdk6D2OYJvwzMBTT6Mtb4thvi5l6Gf21+USJ5w70PJ0jb9XAtV2zavXuhU6AMAAAAAAAAACT0AAAAAAAA=",
    "reservationId": "463",
    "sponsor": "0x3e8cb5be2d86f8b997a19fdb5f94489e70ef43c9d236fd5c0b55db36af5ee854"
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743737524042,
  "traceId": "1743737522622DXpFHe8RBEdPwimTV"
}
```

###### 4.4.6: Send payment transactions {/* {#4-4-6--send-payment-transactions} */}

**Interface address**: /transfer/doProxyPayTx

**Interface parameters**: 

| **Field Name** | **Field Type** | **Field Description** | **Does it be necessary** | **Example** |
| --- | --- | --- | --- | --- |
| reservationId | String[64] | Receipt id | M | 0x559afcb |
| txBytes | String[2048] | Original transaction content | M | false |
| userSig | String[2048] | User Signature | M | ANoVkEd... |


**Request Example**: 

```json
{
	"reservationId": "463",
	"txBytes": "AAADAQDx+HUjw60Tgo9VxKfRLE4adJgTAxm1JH4Ixk2gJ4mFnSMAAAAAAAAAINKPdekL6DNYOESF6Wtj1nHmF1anXdI0GSVTtH5JTTH2AAiAlpgAAAAAAAAghd6u+Bnjpa16T6arGTL2w9QhPRTiusGMnfE7eUis4yACAgEAAAEBAQABAQMAAAAAAQIAVZr8s/KpH0ZP1/5BUwP8fs+VaRXefrUYIpP9DR9dhqQBOjZVPhVDonIxQKaNzQDBtYmeZcUGxiMlCPPFWrl+vpoEAAAAAAAAACCnMs8g247NHxrVoZC8a62kZXpDK4Xdk6D2OYJvwzMBTT6Mtb4thvi5l6Gf21+USJ5w70PJ0jb9XAtV2zavXuhU6AMAAAAAAAAACT0AAAAAAAA=",
	"userSig": "ANoVkEd68riiaup4IjWZIe+kkWr6urrRRT2zcLm4Acv3dZu3NYbiSzrJl4ZjIAdE0dLSnQy9hvpWgkKk6UM0nAQwHVD+4+mojTNKetYfGy+LJteXFUra6RNXmq2hXOl2ZA=="
}
```

**Response data result**: 

| **Field Name** | **Field Type** | **Field Description** | **Example** |
| --- | --- | --- | --- |
| hash | String | hash | 7uqD7ME2... |
| status | String | Transaction status | true |


**Response Example**: 

```json
{
  "code": "000000",
  "data": {
    "hash": "7uqD7ME25VV3GpM5S4vqPFsg27EcSAs4wGgmGoBDA7Jm",
    "status": true
  },
  "msg": "success",
  "success": true,
  "systemTime": 1743737593336,
  "traceId": "1743737592695qRNsZbWg2xQw4hmiP"
}
```

#### 5: Common error codes {/* {#5--common-error-codes} */}

| **Response code** | **Description msg** |
| --- | --- |
| **A00000** | **Server Error** |
| **A00001** | **Merchant signature configuration does not exist** |
| **A00002** | **Invalid signature** |
| **A00003** | **Request has expired** |
| **A00004** | **Merchant does not exist** |
| **A00005** | **ip is not in the whitelist of visits** |
|  |  |
|  |  |


#### 6: Additional information {/* {#6--additional-information} */}

zklogin flow chart

![](https://cdn.nlark.com/yuque/0/2025/png/55242415/1743823740182-8b37219c-f046-48d4-9f18-4e43ff9081e1.png)

### OneChain Wallet Rust Sdk

OneChain Wallet Rust SDK is a Rust client SDK for interacting with the OneChain Wallet service.It provides a series of
API interfaces for implementing identity authentication, payment transactions,financial services and other functions.

#### Getting started {/* {#getting-started} */}

```toml
tokio = { version = "1", features = ["full"] }
onechain_wallet_rust_sdk = { git = "https://github.com/one-chain-labs/onechain-wallet-rust-sdk.git" }
sui_sdk = { git = "https://github.com/one-chain-labs/onechain.git", package = "sui-sdk" }
anyhow = "1.0.97"
num-bigint = "0.4.4"
```

#### ZKLogin {/* {#zklogin} */}

##### 1.Send Sms Code {/* {#send_sms_code} */}

```rust
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::DIDApi;
use onechain_wallet_rust_sdk::types::did::SmsCodeSendReq;

async fn send_sms_code(service: &OneChainWalletService) -> anyhow::Result<String> {
    let req = SmsCodeSendReq {
        mobile: "123123123".to_string(),
        mobile_prefix: "855".to_string(),
        provider: "huione".to_string(),
    };

    // get sms code
    let sms_code = service.send_code(req).await?.get_data()?;
    Ok(sms_code)
}

```

##### 2.Get Sms Auth Number {/* {#get_sms_auth_number} */}

```rust
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::DIDApi;
use onechain_wallet_rust_sdk::types::did::SmsAuthenticateReq;

async fn sms_auth(service: &OneChainWalletService, sms_code: String) -> anyhow::Result<String> {
    let req = SmsAuthenticateReq {
        mobile_prefix: "855".to_string(),
        mobile: "123123123".to_string(),
        provider: "huione".to_string(),
        sms_code: "000000".to_string(),
        code: sms_code,
    };
    let rsp = service.sms(req).await?.get_data()?;
    Ok(rsp.code)
}

```

##### 3.Get Zk JWT Token {/* {#get_zk_jwt_token} */}

```rust
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::fastcrypto::ed25519::Ed25519KeyPair;
use onechain_wallet_rust_sdk::fastcrypto::traits::KeyPair;
use onechain_wallet_rust_sdk::fastcrypto_zkp::bn254::utils::get_nonce;
use onechain_wallet_rust_sdk::rpc::DIDApi;
use onechain_wallet_rust_sdk::sui_types::crypto::SuiKeyPair;
use onechain_wallet_rust_sdk::types::common::ACCESS_TOKEN;
use onechain_wallet_rust_sdk::types::did::{AuthorizeTokenProfileReq, AuthorizeTokenProfileResp};
use rand::{random, thread_rng};
use sui_sdk::SuiClient;

async fn get_jwt_token(
    sui_client: &SuiClient,
    service: &mut OneChainWalletService,
    auth_number: String,
) -> anyhow::Result<(SuiKeyPair, String, AuthorizeTokenProfileResp)> {
    let summary = sui_client
        .governance_api()
        .get_latest_sui_system_state()
        .await?;

    let max_epoch = 30 + summary.epoch;
    let skp = SuiKeyPair::Ed25519(Ed25519KeyPair::generate(&mut thread_rng()));
    let jwt_randomness = random::<i128>().abs().to_string();
    let eph_pk_bytes = skp.to_bytes();
    let nonce = get_nonce(&eph_pk_bytes, max_epoch, &jwt_randomness)?;

    let req = AuthorizeTokenProfileReq {
        provider: "huione".to_string(),
        code: auth_number,
        login_type: "sms".to_string(),
        nonce: nonce.clone(),
    };
    let rsp = service.get_token(req).await?.get_data()?;
    // set token header
    service.set_header(ACCESS_TOKEN.to_string(), rsp.access_token.clone());

    Ok((skp, nonce, rsp))
}
```

##### 4.Get ZK Proof {/* {#get_zk_proof} */}

```rust
use onechain_wallet_rust_sdk::fastcrypto_zkp::bn254::zk_login::ZkLoginInputsReader;
use num_bigint::BigUint;
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::DIDApi;
use onechain_wallet_rust_sdk::types::did::{AuthorizeTokenProfileResp, ZkProofsReq};
use onechain_wallet_rust_sdk::sui_types::crypto::SuiKeyPair;

async fn get_zk_proof(
    service: &OneChainWalletService,
    max_epoch: i64,
    jwt_randomness: String,
    skp: &SuiKeyPair,
    jwt_token_rsp: &AuthorizeTokenProfileResp,
) -> anyhow::Result<ZkLoginInputsReader> {
    let extended_ephemeral_public_key = BigUint::from_bytes_be(&skp.to_bytes()).to_string();

    let req = ZkProofsReq {
        max_epoch,
        jwt_randomness,
        extended_ephemeral_public_key,
        jwt: jwt_token_rsp.jwt_token.clone(),
        salt: jwt_token_rsp.salt.clone(),
        key_claim_name: "sub".to_string(),
    };
    let reader = service.get_zk_proofs(req).await?.get_data()?;
    Ok(reader)
}

```

##### 5.Refresh JWT Token {/* {#refresh_jwt_token} */}

**Prerequisites**

```rust
// set token header
service.set_header(ACCESS_TOKEN.to_string(), rsp.access_token.clone());
```

```rust
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::DIDApi;
use onechain_wallet_rust_sdk::types::did::{AuthorizeTokenProfileResp, RefreshJwtTokenReq};

async fn refresh_jwt_token(
    service: &OneChainWalletService,
    nonce: String,
) -> anyhow::Result<AuthorizeTokenProfileResp> {
    let req = RefreshJwtTokenReq { nonce };
    let resp = service.refresh_jwt_token(req).await?.get_data()?;
    Ok(resp)
}

```

#### Build Transfer Tx {/* {#build-transfer-tx} */}

##### 1.Create Transfer tx {/* {#create_transfer_tx} */}

```rust
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::TransferApi;
use onechain_wallet_rust_sdk::types::common::CreateOrderResp;
use onechain_wallet_rust_sdk::types::transfer::TransferOrderReq;

async fn create_tx(
    service: &OneChainWalletService,
    from_address: String,
    to_address: String,
) -> anyhow::Result<CreateOrderResp> {
    let req = TransferOrderReq {
        from_address,
        to_address,
        coin_type: "OCT".to_string(),
        amount: 0.001.to_string(),
        remark: None,
    };

    let resp = service.create_order(req).await?.get_data()?;

    Ok(resp)
}
```

##### 2.Sign Tx & Send Tx {/* {#sign_and_send_tx} */}

```rust
use onechain_wallet_rust_sdk::fastcrypto_zkp::bn254::zk_login::ZkLoginInputs;
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::TransferApi;
use onechain_wallet_rust_sdk::types::common::CreateOrderResp;
use onechain_wallet_rust_sdk::types::transfer::{TransferOrderTxReq, TransferOrderTxResponse};
use onechain_wallet_rust_sdk::utils::zk_login::zklogin_sign_tx_bytes;
use onechain_wallet_rust_sdk::sui_types::crypto::SuiKeyPair;

async fn send_tx(
    service: &OneChainWalletService,
    tx_order: CreateOrderResp,
    keypair: &SuiKeyPair,
    max_epoch: u64,
    zk_login_inputs: ZkLoginInputs,
) -> anyhow::Result<TransferOrderTxResponse> {
    let user_sign = zklogin_sign_tx_bytes(
        max_epoch,
        keypair,
        zk_login_inputs,
        tx_order.raw_transaction.clone(),
    )?;

    let req = TransferOrderTxReq {
        hash: tx_order.hash,
        tx_bytes: tx_order.raw_transaction,
        user_sig: user_sign,
    };

    let tx_resp = service.send_tx(req).await?.get_data()?;
    Ok(tx_resp)
}
```

#### Build Sponsor Tx {/* {#build-sponsor-tx} */}

##### 1.Build Sponsor Ptb Tx Base64 {/* {#build_sponsor_ptb_tx_base64} */}

```rust
use onechain_wallet_rust_sdk::fastcrypto::encoding::{Base64, Encoding};
use sui_sdk::SuiClient;
use sui_sdk::rpc_types::SuiObjectDataOptions;
use onechain_wallet_rust_sdk::sui_types::base_types::SuiAddress;
use onechain_wallet_rust_sdk::sui_types::programmable_transaction_builder::ProgrammableTransactionBuilder;
use onechain_wallet_rust_sdk::sui_types::transaction::TransactionData;

async fn build_ptb_tx_base64(sui_client: &SuiClient, from: SuiAddress) -> anyhow::Result<String> {
    let coins = sui_client
        .coin_read_api()
        .get_coins(from, Some("0x2::oct::OCT".to_string()), None, None)
        .await?;

    let object = sui_client
        .read_api()
        .get_object_with_options(coins.data[0].coin_object_id, SuiObjectDataOptions::new())
        .await?
        .data
        .unwrap();

    let pt = {
        let mut builder = ProgrammableTransactionBuilder::new();
        builder.transfer_object(from, object.object_ref()).unwrap();
        builder.finish()
    };
    let data = TransactionData::new_programmable(from, vec![], pt, 100000000, 1000);
    Ok(Base64::encode(&bcs::to_bytes(&data)?))
}
```

##### 2.Create Sponsor tx {/* {#create_sponsor_tx} */}

```rust
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::TransferApi;
use onechain_wallet_rust_sdk::types::transfer::{BuildSponsorTxReq, GasTxBuilderResponse};

async fn create_sponsor_tx(
    service: &OneChainWalletService,
    wallet_address: String,
    tx_base64: String,
) -> anyhow::Result<GasTxBuilderResponse> {
    let req = BuildSponsorTxReq {
        address: wallet_address,
        raw_transaction: tx_base64,
        only_transaction_kind: false,
        gas_budget: Some(0.01.to_string()),
    };

    let resp = service.build_sponsor_tx(req).await?.get_data()?;

    Ok(resp)
}
```

##### 3.Sign Tx && Send Tx {/* {#sign_sponsor_tx_and_send_tx} */}

```rust
use onechain_wallet_rust_sdk::fastcrypto_zkp::bn254::zk_login::ZkLoginInputs;
use onechain_wallet_rust_sdk::client::OneChainWalletService;
use onechain_wallet_rust_sdk::rpc::TransferApi;
use onechain_wallet_rust_sdk::types::transfer::{
    GasTxBuilderResponse, ProxyPayTxReq, ProxyPayTxResp,
};
use onechain_wallet_rust_sdk::utils::zk_login::zklogin_sign_tx_bytes;
use onechain_wallet_rust_sdk::sui_types::crypto::SuiKeyPair;

async fn sign_sponsor_tx_and_send_tx(
    service: &OneChainWalletService,
    sponsor_order: GasTxBuilderResponse,
    keypair: &SuiKeyPair,
    max_epoch: u64,
    zk_login_inputs: ZkLoginInputs,
) -> anyhow::Result<ProxyPayTxResp> {
    let user_sign = zklogin_sign_tx_bytes(
        max_epoch,
        keypair,
        zk_login_inputs,
        sponsor_order.raw_transaction.clone(),
    )?;

    let req = ProxyPayTxReq {
        user_sig: user_sign,
        tx_bytes: sponsor_order.raw_transaction,
        reservation_id: sponsor_order.reservation_id,
    };

    let resp = service.do_proxy_pay_tx(req).await?.get_data()?;
    Ok(resp)
}
```

### One chain wallet java sdk

#### How to use it {/* {#how_to_use_it} */}

```java
mvn -DskipTests=true install
```

##### Maven {/* {#maven} */}

```xml
<dependency>
    <groupId>io.xone.chain</groupId>
    <artifactId>java-wallet</artifactId>
    <version>1.0.0</version>
</dependency>
```

##### Connecting to wallet {/* {#connecting_to_wallet} */}

- devnet-wallet:https://onechain-api.tpknp.com/app/api/

- mainnet-wallet:

```java
huioneWalletClient = new OkhttpHuioneWalletClient("<wallet_url>");
```

##### Huione login {/* {#huione_login} */}

###### zklogin {/* {#zklogin-1} */}

```java
public static void login(){
        SmsCodeSendReq step1Req = new SmsCodeSendReq();
        step1Req.setMobile(MOBILE);
        step1Req.setMobilePrefix("855");
        step1Req.setTimestamp(System.currentTimeMillis());
        step1Req.setMerchantId("1000000");
        step1Req.setMerchantSign(RsaSignUtil.sign(step1Req,REQUEST_PRIKEY));
        CommonResp<String> step1Resp = didApi.sendCode(step1Req).get();
        assert step1Resp.isSuccess();
        //step2
        SmsAuthenticateRequest step2Req = new SmsAuthenticateRequest();
        step2Req.setMobile(MOBILE);
        step2Req.setMobilePrefix("855");
        step2Req.setSmsCode("000000");
        step2Req.setCode(step1Resp.getData());
        CommonResp<AuthenticateUserResponse> step2Resp = didApi.sms(step2Req).get();
        assert step2Resp.isSuccess();


        //step3
        AuthorizeTokenProfileRequest step3Req = new AuthorizeTokenProfileRequest();
        MAX_EPOCH = oneChain.getLatestOneChainSystemState().get().getEpoch().add(BigInteger.TEN);
        TEMP_KEYPAIR = OneChainKeyGen.getInstance().generateNewKeyPair(SignatureScheme.ED25519);
        RANDOMNESS = NonceGenerator.generateRandomness();
        String nonce = NonceGenerator.generateNonce(TEMP_KEYPAIR.publicKeyBytes(), MAX_EPOCH, RANDOMNESS);
        step3Req.setCode(step2Resp.getData().getCode());
        step3Req.setNonce(nonce);
        CommonResp<AuthorizeTokenProfileResponse> step3Resp = didApi.getToken(step3Req).get();
        TOKEN_PROFILE = step3Resp.getData();
        assert step3Resp.isSuccess();

        //step4
        AuthorizeTokenProfileResponse.AccessTokenProfile jwtToken = TOKEN_PROFILE.getAccessTokenProfile();
        ZK_LOGIN_ADDRESS = ZkLoginAddressUtil.computeZkLoginAddress("sub", jwtToken.getSub(), jwtToken.getIss(), jwtToken.getAud(), TOKEN_PROFILE.getSalt(), false);
        HeaderRequest headerRequest = new HeaderRequest();
        headerRequest.setAccessToken(TOKEN_PROFILE.getAccessToken());
        headerRequest.setTokenId(jwtToken.getJti());
        huioneWalletClient.fillHeader(headerRequest);
        CommonResp<UserTokenProfile> userTokenProfileCommonResp = didApi.getTokenUserProfile().get();
        assert userTokenProfileCommonResp.isSuccess();

        //step5
        String jwt = TOKEN_PROFILE.getJwtToken();
        ZK_LOGIN_DATA = requestZkService(MAX_EPOCH, RANDOMNESS.toString(), TEMP_KEYPAIR.publicKey(), jwt, TOKEN_PROFILE.getSalt());
        DID = userTokenProfileCommonResp.getData().getDid();
        requestOneChainFromFaucet();
    }
```
For more examples, you can see [HuionePayTest](src/test/java/io/onechain/HuionePayTest.java)

###### sponsored coin transfer transaction {/* {#sponsored_coin_transfer_transaction} */}

```java
@Test
    public void testTransfer() {
        TransferOrderReq transferOrderReq = new TransferOrderReq();
        transferOrderReq.setRemark("test");
        transferOrderReq.setCurrency("USDH");
        transferOrderReq.setAmount(BigDecimal.valueOf(0.5));
        transferOrderReq.setFromAddress(ZK_LOGIN_ADDRESS);
        transferOrderReq.setToAddress(UN_KNOW_ADDRESS);
        CommonResp<CreateOrderResp> createOrderRespCommonResp = transferApi.createOrder(transferOrderReq).get();
        assert createOrderRespCommonResp.isSuccess();
        CreateOrderResp order = createOrderRespCommonResp.getData();
        BigInteger addressSeed = AddressSeedGenerator.genAddressSeed(new BigInteger(TOKEN_PROFILE.getSalt()), "sub", TOKEN_PROFILE.getAccessTokenProfile().getSub(), TOKEN_PROFILE.getAccessTokenProfile().getAud());
        String signed = OneChain.signTransactionBlockByte(TEMP_KEYPAIR.encodePrivateKey(), Base64.getDecoder().decode(order.getRawTransaction()));
        ZkLoginSignature zkLoginSignature = ZkLoginSignature.createZkLoginSignature(ZK_LOGIN_DATA, Base64.getDecoder().decode(signed), MAX_EPOCH.longValue(), addressSeed.toString());
        String zkLoginSignatureStr = Base64.getEncoder().encodeToString(zkLoginSignature.bcsSerialize());
        TransferOrderTxReq transferOrderTxReq = new TransferOrderTxReq();
        transferOrderTxReq.setHash(order.getHash());
        transferOrderTxReq.setUserSig(zkLoginSignatureStr);
        transferOrderTxReq.setTxBytes(order.getRawTransaction());
        CommonResp<TransferOrderTxResp> transferOrderTxRespCommonResp = transferApi.sendTx(transferOrderTxReq).get();
        assert transferOrderTxRespCommonResp.isSuccess();
    }
```
For more examples, you can see [HuionePayTest](src/test/java/io/onechain/HuionePayTest.java)

###### sponsored any type of transaction  {/* {#sponsored_any_type_of_transaction} */}

```java
@SneakyThrows
    @Test
    public void testSponsorTransaction() {
        BuildSponsorTransactionRequest buildSponsorTransactionRequest = new BuildSponsorTransactionRequest();
        buildSponsorTransactionRequest.setRawTransaction(buildTransferData(ZK_LOGIN_ADDRESS));
        buildSponsorTransactionRequest.setAddress(ZK_LOGIN_ADDRESS);
        CommonResp<GasTxBuilderResponse> gasTxBuilderResponseCommonResp = transferApi.buildSponsorTransaction(buildSponsorTransactionRequest).get();
        assert gasTxBuilderResponseCommonResp.isSuccess();
        GasTxBuilderResponse data = gasTxBuilderResponseCommonResp.getData();
        BigInteger addressSeed = AddressSeedGenerator.genAddressSeed(new BigInteger(TOKEN_PROFILE.getSalt()), "sub", TOKEN_PROFILE.getAccessTokenProfile().getSub(), TOKEN_PROFILE.getAccessTokenProfile().getAud());
        String signed = OneChain.signTransactionBlockByte(TEMP_KEYPAIR.encodePrivateKey(), Base64.getDecoder().decode(data.getRawTransaction()));
        ZkLoginSignature zkLoginSignature = ZkLoginSignature.createZkLoginSignature(ZK_LOGIN_DATA, Base64.getDecoder().decode(signed), MAX_EPOCH.longValue(), addressSeed.toString());
        String zkLoginSignatureStr = Base64.getEncoder().encodeToString(zkLoginSignature.bcsSerialize());
        ProxyPayTxRequest proxyPayTxRequest = new ProxyPayTxRequest();
        proxyPayTxRequest.setReservationId(data.getReservationId());
        proxyPayTxRequest.setUserSig(zkLoginSignatureStr);
        proxyPayTxRequest.setTxBytes(data.getRawTransaction());
        CommonResp<ProxyPayTxResp> proxyPayTxRespCommonResp = transferApi.doProxyPayTx(proxyPayTxRequest).get();
        assert proxyPayTxRespCommonResp.isSuccess();
        System.out.println(proxyPayTxRespCommonResp);
    }
```
For more examples, you can see [HuionePayTest](src/test/java/io/onechain/HuionePayTest.java)
